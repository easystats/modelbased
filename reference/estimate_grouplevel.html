<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Group-specific parameters of mixed models random effects — estimate_grouplevel • modelbased</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Group-specific parameters of mixed models random effects — estimate_grouplevel"><meta name="description" content="Extract random parameters of each individual group in the context of mixed
models, commonly referred to as BLUPs (Best Linear Unbiased Predictors).
Can be reshaped to be of the same dimensions as the original data,
which can be useful to add the random effects to the original data."><meta property="og:description" content="Extract random parameters of each individual group in the context of mixed
models, commonly referred to as BLUPs (Best Linear Unbiased Predictors).
Can be reshaped to be of the same dimensions as the original data,
which can be useful to add the random effects to the original data."><meta property="og:image" content="https://easystats.github.io/modelbased/reference/figures/card.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@easystats4u"><meta name="twitter:site" content="@easystats4u"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-introductions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Introductions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-introductions"><li><a class="dropdown-item" href="../articles/overview_of_vignettes.html">Overview of Vignettes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_models.html">Mixed effects models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpretation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_response.html">Use a model to make predictions</a></li>
    <li><a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualization</h6></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_relation.html">Visualize effects and interactions</a></li>
    <li><a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies"><li><h6 class="dropdown-header" data-toc-skip>Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/workflow_modelbased.html">Understanding your models</a></li>
    <li><a class="dropdown-item" href="../articles/practical_causality.html">Causal inference for observational data</a></li>
    <li><a class="dropdown-item" href="../articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Contrasts</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_1.html">Contrasts and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_2.html">Slopes, floodlight and spotlight analysis (Johnson-Neyman intervals)</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_3.html">Contrasts and comparisons for generalized linear models</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_4.html">Contrasts and comparisons for zero-inflation models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats"><li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Group-specific parameters of mixed models random effects</h1>
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/main/R/estimate_grouplevel.R" class="external-link"><code>R/estimate_grouplevel.R</code></a>, <a href="https://github.com/easystats/modelbased/blob/main/R/reshape_grouplevel.R" class="external-link"><code>R/reshape_grouplevel.R</code></a></small>
      <div class="d-none name"><code>estimate_grouplevel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract random parameters of each individual group in the context of mixed
models, commonly referred to as BLUPs (Best Linear Unbiased Predictors).
Can be reshaped to be of the same dimensions as the original data,
which can be useful to add the random effects to the original data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_grouplevel</span><span class="op">(</span><span class="va">model</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">estimate_grouplevel</span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"random"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'brmsfit'</span></span>
<span><span class="fu">estimate_grouplevel</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  dispersion <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diagnostic <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">reshape_grouplevel</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'estimate_grouplevel'</span></span>
<span><span class="fu">reshape_grouplevel</span><span class="op">(</span><span class="va">x</span>, indices <span class="op">=</span> <span class="st">"all"</span>, group <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A mixed model with random effects.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to <code><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters::model_parameters()</a></code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p><code>"random"</code> or <code>"total"</code>. If <code>"random"</code> (default), the
coefficients correspond to the conditional estimates of  the random effects
(as they are returned by <code><a href="https://rdrr.io/pkg/nlme/man/random.effects.html" class="external-link">lme4::ranef()</a></code>). They typically correspond to the
deviation of each individual group from their fixed effect (assuming the
random effect is also included as a fixed effect). As such, a coefficient
close to 0 means that the participants' effect is the same as the
population-level effect (in other words, it is "in the norm"). If
<code>"total"</code>, it will return the sum of the random effect and its
corresponding fixed effects, which internally relies on the <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> method
(see <code><a href="https://rdrr.io/pkg/lme4/man/merMod-class.html" class="external-link">?coef.merMod</a></code>). Note that <code>type = "total"</code> yet does not return
uncertainty indices (such as SE and CI) for models from <em>lme4</em> or
<em>glmmTMB</em>, as the necessary information to compute them is not yet
available. However, for Bayesian models, it is possible to compute them.</p></dd>


<dt id="arg-dispersion-test-diagnostic">dispersion, test, diagnostic<a class="anchor" aria-label="anchor" href="#arg-dispersion-test-diagnostic"></a></dt>
<dd><p>Arguments passed to
<code><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters::model_parameters()</a></code> for Bayesian models. By default, it won't
return significance or diagnostic indices (as it is not typically very
useful).</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The output of <code>estimate_grouplevel()</code>.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>A character vector containing the indices (i.e., which
columns) to extract (e.g., "Coefficient", "Median").</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>The name of the random factor to select as string value (e.g.,
<code>"Participant"</code>, if the model was <code>y ~ x + (1|Participant)</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Unlike raw group means, BLUPs apply shrinkage: they are a compromise between
the group estimate and the population estimate. This improves generalizability
and prevents overfitting.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># lme4 model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">carb</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">random</span> <span class="op">&lt;-</span> <span class="fu">estimate_grouplevel</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show group-specific effects</span></span></span>
<span class="r-in"><span><span class="va">random</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group | Level | Parameter   | Coefficient |   SE |        95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 1     | (Intercept) |        0.41 | 0.84 | [-1.24, 2.05]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 2     | (Intercept) |        0.11 | 0.78 | [-1.42, 1.65]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 3     | (Intercept) |       -0.32 | 0.94 | [-2.16, 1.51]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 4     | (Intercept) |       -0.78 | 0.78 | [-2.31, 0.75]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 6     | (Intercept) |        0.09 | 1.00 | [-1.87, 2.05]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 8     | (Intercept) |        0.50 | 1.00 | [-1.47, 2.46]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualize random effects</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">random</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="estimate_grouplevel-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reshape to wide data...</span></span></span>
<span class="r-in"><span><span class="va">reshaped</span> <span class="op">&lt;-</span> <span class="fu">reshape_grouplevel</span><span class="op">(</span><span class="va">random</span>, group <span class="op">=</span> <span class="st">"carb"</span>, indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Coefficient"</span>, <span class="st">"SE"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ...and can be easily combined with the original data</span></span></span>
<span class="r-in"><span><span class="va">alldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">reshaped</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># overall coefficients</span></span></span>
<span class="r-in"><span><span class="fu">estimate_grouplevel</span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"total"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group | Level | Parameter   | Coefficient</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 1     | (Intercept) |       30.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 2     | (Intercept) |       29.88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 3     | (Intercept) |       29.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 4     | (Intercept) |       28.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 6     | (Intercept) |       29.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> carb  | 8     | (Intercept) |       30.27</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="https://remi-theriault.com/" class="external-link">Rémi Thériault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.9000.</p>
</div>

    </footer></div>





  </body></html>

