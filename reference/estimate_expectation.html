<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model-based predictions — estimate_expectation • modelbased</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model-based predictions — estimate_expectation"><meta name="description" content='After fitting a model, it is useful generate model-based estimates of the
response variables for different combinations of predictor values. Such
estimates can be used to make inferences about relationships between
variables, to make predictions about individual cases, or to compare the
predicted values against the observed data.
The modelbased package includes 4 "related" functions, that mostly differ in
their default arguments (in particular, data and predict):
estimate_prediction(data = NULL, predict = "prediction", ...)
estimate_expectation(data = NULL, predict = "expectation", ...)
estimate_relation(data = "grid", predict = "expectation", ...)
estimate_link(data = "grid", predict = "link", ...)


While they are all based on model-based predictions (using
insight::get_predicted()), they differ in terms of the type of
predictions they make by default. For instance, estimate_prediction() and
estimate_expectation() return predictions for the original data used to fit
the model, while estimate_relation() and estimate_link() return
predictions on a insight::get_datagrid(). Similarly, estimate_link
returns predictions on the link scale, while the others return predictions on
the response scale. Note that the relevance of these differences depends on
the model family (for instance, for linear models, estimate_relation is
equivalent to estimate_link(), since there is no difference between the
link-scale and the response scale).
Note that you can run plot() on
the output of these functions to get some visual insights (see the
plotting examples).
See the details section below for details about the different possibilities.'><meta property="og:description" content='After fitting a model, it is useful generate model-based estimates of the
response variables for different combinations of predictor values. Such
estimates can be used to make inferences about relationships between
variables, to make predictions about individual cases, or to compare the
predicted values against the observed data.
The modelbased package includes 4 "related" functions, that mostly differ in
their default arguments (in particular, data and predict):
estimate_prediction(data = NULL, predict = "prediction", ...)
estimate_expectation(data = NULL, predict = "expectation", ...)
estimate_relation(data = "grid", predict = "expectation", ...)
estimate_link(data = "grid", predict = "link", ...)


While they are all based on model-based predictions (using
insight::get_predicted()), they differ in terms of the type of
predictions they make by default. For instance, estimate_prediction() and
estimate_expectation() return predictions for the original data used to fit
the model, while estimate_relation() and estimate_link() return
predictions on a insight::get_datagrid(). Similarly, estimate_link
returns predictions on the link scale, while the others return predictions on
the response scale. Note that the relevance of these differences depends on
the model family (for instance, for linear models, estimate_relation is
equivalent to estimate_link(), since there is no difference between the
link-scale and the response scale).
Note that you can run plot() on
the output of these functions to get some visual insights (see the
plotting examples).
See the details section below for details about the different possibilities.'><meta property="og:image" content="https://easystats.github.io/modelbased/reference/figures/card.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@easystats4u"><meta name="twitter:site" content="@easystats4u"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.2.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-introductions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Introductions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-introductions"><li><a class="dropdown-item" href="../articles/overview_of_vignettes.html">Overview of Vignettes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_models.html">Mixed effects models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpretation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_response.html">Use a model to make predictions</a></li>
    <li><a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualization</h6></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_relation.html">Visualize effects and interactions</a></li>
    <li><a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies"><li><h6 class="dropdown-header" data-toc-skip>Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/workflow_modelbased.html">Understanding your models</a></li>
    <li><a class="dropdown-item" href="../articles/practical_causality.html">Causal inference for observational data</a></li>
    <li><a class="dropdown-item" href="../articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a></li>
    <li><a class="dropdown-item" href="../articles/practical_its.html">Interrupted Time Series Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/practical_growthmixture.html">An Introduction to Growth Mixture Models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Contrasts</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_1.html">Contrasts and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_2.html">User Defined Contrasts and Joint Tests</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_3.html">Slopes, floodlight and spotlight analysis (Johnson-Neyman intervals)</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_4.html">Contrasts and comparisons for generalized linear models</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_5.html">Contrasts and comparisons for zero-inflation models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats"><li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model-based predictions</h1>
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/main/R/estimate_predicted.R" class="external-link"><code>R/estimate_predicted.R</code></a></small>
      <div class="d-none name"><code>estimate_expectation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>After fitting a model, it is useful generate model-based estimates of the
response variables for different combinations of predictor values. Such
estimates can be used to make inferences about <strong>relationships</strong> between
variables, to make predictions about individual cases, or to compare the
<strong>predicted</strong> values against the observed data.</p>
<p>The <code>modelbased</code> package includes 4 "related" functions, that mostly differ in
their default arguments (in particular, <code>data</code> and <code>predict</code>):</p><ul><li><p><code>estimate_prediction(data = NULL, predict = "prediction", ...)</code></p></li>
<li><p><code>estimate_expectation(data = NULL, predict = "expectation", ...)</code></p></li>
<li><p><code>estimate_relation(data = "grid", predict = "expectation", ...)</code></p></li>
<li><p><code>estimate_link(data = "grid", predict = "link", ...)</code></p></li>
</ul><p>While they are all based on model-based predictions (using
<code><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">insight::get_predicted()</a></code>), they differ in terms of the <strong>type</strong> of
predictions they make by default. For instance, <code>estimate_prediction()</code> and
<code>estimate_expectation()</code> return predictions for the original data used to fit
the model, while <code>estimate_relation()</code> and <code>estimate_link()</code> return
predictions on a <code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">insight::get_datagrid()</a></code>. Similarly, <code>estimate_link</code>
returns predictions on the link scale, while the others return predictions on
the response scale. Note that the relevance of these differences depends on
the model family (for instance, for linear models, <code>estimate_relation</code> is
equivalent to <code>estimate_link()</code>, since there is no difference between the
link-scale and the response scale).</p>
<p>Note that you can run <code><a href="visualisation_recipe.estimate_predicted.html">plot()</a></code> on
the output of these functions to get some visual insights (see the
<a href="visualisation_recipe.estimate_predicted.html">plotting examples</a>).</p>
<p>See the <strong>details</strong> section below for details about the different possibilities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_expectation</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predict <span class="op">=</span> <span class="st">"expectation"</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iterations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_iterations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">estimate_link</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  data <span class="op">=</span> <span class="st">"grid"</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predict <span class="op">=</span> <span class="st">"link"</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iterations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_iterations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">estimate_prediction</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predict <span class="op">=</span> <span class="st">"prediction"</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iterations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_iterations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">estimate_relation</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  data <span class="op">=</span> <span class="st">"grid"</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predict <span class="op">=</span> <span class="st">"expectation"</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iterations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_iterations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A statistical model.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame with model's predictors to estimate the response. If
<code>NULL</code>, the model's data is used. If <code>"grid"</code>, the model matrix is obtained
(through <code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">insight::get_datagrid()</a></code>).</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>The predictor variable(s) at which to estimate the response. Other
predictors of the model that are not included here will be set to their mean
value (for numeric predictors), reference level (for factors) or mode (other
types). The <code>by</code> argument will be used to create a data grid via
<code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">insight::get_datagrid()</a></code>, which will then be used as <code>data</code> argument. Thus,
you cannot specify both <code>data</code> and <code>by</code> but only of these two arguments.</p></dd>


<dt id="arg-predict">predict<a class="anchor" aria-label="anchor" href="#arg-predict"></a></dt>
<dd><p>This parameter controls what is predicted (and gets internally
passed to <code><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">insight::get_predicted()</a></code>). In most cases, you don't need to care
about it: it is changed automatically according to the different predicting
functions (i.e., <code>estimate_expectation()</code>, <code>estimate_prediction()</code>, <code>estimate_link()</code>
or <code>estimate_relation()</code>). The only time you might be interested in manually
changing it is to estimate other distributional parameters (called "dpar" in
other packages) - for instance when using complex formulae in <code>brms</code> models.
The <code>predict</code> argument can then be set to the parameter you want to
estimate, for instance <code>"sigma"</code>, <code>"kappa"</code>, etc. Note that the distinction
between <code>"expectation"</code>, <code>"link"</code> and <code>"prediction"</code> does not then apply (as
you are directly predicting the value of some distributional parameter), and
the corresponding functions will then only differ in the default value of
their <code>data</code> argument.</p></dd>


<dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>Confidence Interval (CI) level. Default to <code>0.95</code> (<code>95%</code>).</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>A function applied to predictions and confidence intervals
to (back-) transform results, which can be useful in case the regression
model has a transformed response variable (e.g., <code>lm(log(y) ~ x)</code>). Can also
be <code>TRUE</code>, in which case <code><a href="https://easystats.github.io/insight/reference/get_transformation.html" class="external-link">insight::get_transformation()</a></code> is called to
determine the appropriate transformation-function. Note that no standard
errors are returned when transformations are applied.</p></dd>


<dt id="arg-iterations">iterations<a class="anchor" aria-label="anchor" href="#arg-iterations"></a></dt>
<dd><p>For Bayesian models, this corresponds to the number of
posterior draws. If <code>NULL</code>, will use all the draws (one for each iteration of
the model). For frequentist models, if not <code>NULL</code>, will generate bootstrapped
draws, from which bootstrapped CIs will be computed. Use <code>keep_iterations</code> to
control if and how many draws will be included in the returned output (data
frame), which can be used, for instance, for plotting.</p></dd>


<dt id="arg-keep-iterations">keep_iterations<a class="anchor" aria-label="anchor" href="#arg-keep-iterations"></a></dt>
<dd><p>If <code>TRUE</code>, will keep all iterations (draws) of
bootstrapped or Bayesian models. They will be added as additional columns
named <code>iter_1</code>, <code>iter_2</code>, and so on. If <code>keep_iterations</code> is a positive
number, only as many columns as indicated in <code>keep_iterations</code> will be added
to the output. You can reshape them to a long format by running
<code><a href="https://easystats.github.io/bayestestR/reference/reshape_iterations.html" class="external-link">bayestestR::reshape_iterations()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>You can add all the additional control arguments from
<code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">insight::get_datagrid()</a></code> (used when <code>data = "grid"</code>) and
<code><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">insight::get_predicted()</a></code>. Furthermore, for count regression models that use
an offset term, use <code>offset = &lt;value&gt;</code> to fix the offset at a specific value.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of predicted values and uncertainty intervals, with
class <code>"estimate_predicted"</code>. Methods for <code><a href="visualisation_recipe.estimate_predicted.html">visualisation_recipe()</a></code>
and <code><a href="visualisation_recipe.estimate_predicted.html">plot()</a></code> are available.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>These functions are built on top of <code><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">insight::get_predicted()</a></code> and correspond
to different specifications of its parameters. It may be useful to read its
<a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">documentation</a>,
in particular the description of the <code>predict</code> argument for additional
details on the difference between expected vs. predicted values and link vs.
response scales.</p>
<p>Additional control parameters can be used to control results from
<code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">insight::get_datagrid()</a></code> (when <code>data = "grid"</code>) and from
<code><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">insight::get_predicted()</a></code> (the function used internally to compute
predictions).</p>
<p>For plotting, check the examples in <code><a href="https://easystats.github.io/datawizard/reference/visualisation_recipe.html" class="external-link">visualisation_recipe()</a></code>. Also check out
the <a href="https://easystats.github.io/modelbased/articles/">Vignettes</a> and <a href="https://easystats.github.io/modelbased/index.html#features">README examples</a> for
various examples, tutorials and usecases.</p>
    </div>
    <div class="section level2">
    <h2 id="expected-average-values">Expected (average) values<a class="anchor" aria-label="anchor" href="#expected-average-values"></a></h2>



<p>The most important way that various types of response estimates differ is in
terms of what quantity is being estimated and the meaning of the uncertainty
intervals. The major choices are <strong>expected values</strong> for uncertainty in the
regression line and <strong>predicted values</strong> for uncertainty in the individual
case predictions.</p>
<p><strong>Expected values</strong> refer to the fitted regression line - the estimated
<em>average</em> response value (i.e., the "expectation") for individuals with
specific predictor values. For example, in a linear model <em>y</em> = 2 + 3<em>x</em> +
4<em>z</em> + <em>e</em>, the estimated average <em>y</em> for individuals with <em>x</em> = 1 and <em>z</em> =
2 is 11.</p>
<p>For expected values, uncertainty intervals refer to uncertainty in the
estimated <strong>conditional average</strong> (where might the true regression line
actually fall)? Uncertainty intervals for expected values are also called
"confidence intervals".</p>
<p>Expected values and their uncertainty intervals are useful for describing the
relationship between variables and for describing how precisely a model has
been estimated.</p>
<p>For generalized linear models, expected values are reported on one of two scales:</p><ul><li><p>The <strong>link scale</strong> refers to scale of the fitted regression line, after
transformation by the link function. For example, for a logistic regression
(logit binomial) model, the link scale gives expected log-odds. For a
log-link Poisson model, the link scale gives the expected log-count.</p></li>
<li><p>The <strong>response scale</strong> refers to the original scale of the response
variable (i.e., without any link function transformation). Expected values
on the link scale are back-transformed to the original response variable
metric (e.g., expected probabilities for binomial models, expected counts
for Poisson models).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="individual-case-predictions">Individual case predictions<a class="anchor" aria-label="anchor" href="#individual-case-predictions"></a></h2>



<p>In contrast to expected values, <strong>predicted values</strong> refer to predictions for
<strong>individual cases</strong>. Predicted values are also called "posterior
predictions" or "posterior predictive draws".</p>
<p>For predicted values, uncertainty intervals refer to uncertainty in the
<strong>individual response values for each case</strong> (where might any single case
actually fall)? Uncertainty intervals for predicted values are also called
"prediction intervals" or "posterior predictive intervals".</p>
<p>Predicted values and their uncertainty intervals are useful for forecasting
the range of values that might be observed in new data, for making decisions
about individual cases, and for checking if model predictions are reasonable
("posterior predictive checks").</p>
<p>Predicted values and intervals are always on the scale of the original
response variable (not the link scale).</p>
    </div>
    <div class="section level2">
    <h2 id="functions-for-estimating-predicted-values-and-uncertainty">Functions for estimating predicted values and uncertainty<a class="anchor" aria-label="anchor" href="#functions-for-estimating-predicted-values-and-uncertainty"></a></h2>



<p><em>modelbased</em> provides 4 functions for generating model-based response
estimates and their uncertainty:</p><ul><li><p><strong><code>estimate_expectation()</code></strong>:</p><ul><li><p>Generates <strong>expected values</strong> (conditional average) on the <strong>response scale</strong>.</p></li>
<li><p>The uncertainty interval is a <em>confidence interval</em>.</p></li>
<li><p>By default, values are computed using the data used to fit the model.</p></li>
</ul></li>
<li><p><strong><code>estimate_link()</code></strong>:</p><ul><li><p>Generates <strong>expected values</strong> (conditional average) on the <strong>link scale</strong>.</p></li>
<li><p>The uncertainty interval is a <em>confidence interval</em>.</p></li>
<li><p>By default, values are computed using a reference grid spanning the
observed range of predictor values (see <code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">insight::get_datagrid()</a></code>).</p></li>
</ul></li>
<li><p><strong><code>estimate_prediction()</code></strong>:</p><ul><li><p>Generates <strong>predicted values</strong> (for individual cases) on the <strong>response scale</strong>.</p></li>
<li><p>The uncertainty interval is a <em>prediction interval</em>.</p></li>
<li><p>By default, values are computed using the data used to fit the model.</p></li>
</ul></li>
<li><p><strong><code>estimate_relation()</code></strong>:</p><ul><li><p>Like <code>estimate_expectation()</code>.</p></li>
<li><p>Useful for visualizing a model.</p></li>
<li><p>Generates <strong>expected values</strong> (conditional average) on the <strong>response scale</strong>.</p></li>
<li><p>The uncertainty interval is a <em>confidence interval</em>.</p></li>
<li><p>By default, values are computed using a reference grid spanning the
observed range of predictor values (see <code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">insight::get_datagrid()</a></code>).</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="data-for-predictions">Data for predictions<a class="anchor" aria-label="anchor" href="#data-for-predictions"></a></h2>



<p>If the <code>data = NULL</code>, values are estimated using the data used to fit the
model. If <code>data = "grid"</code>, values are computed using a reference grid
spanning the observed range of predictor values with
<code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">insight::get_datagrid()</a></code>. This can be useful for model visualization. The
number of predictor values used for each variable can be controlled with the
<code>length</code> argument. <code>data</code> can also be a data frame containing columns with
names matching the model frame (see <code><a href="https://easystats.github.io/insight/reference/get_data.html" class="external-link">insight::get_data()</a></code>). This can be used
to generate model predictions for specific combinations of predictor values.</p>
    </div>
    <div class="section level2">
    <h2 id="finite-mixture-models">Finite mixture models<a class="anchor" aria-label="anchor" href="#finite-mixture-models"></a></h2>



<p>For finite mixture models (currently, only the <code><a href="https://paulbuerkner.com/brms/reference/mixture.html" class="external-link">brms::mixture()</a></code> family
from package <em>brms</em> is supported), use <code>predict = "classification"</code> with
<code>data = NULL</code> to predict the class membership for each observation (e.g.,
<code>estimate_prediction(model, predict = "classification")</code>). To return
predicted values stratified by class membership, use <code>predict = "link"</code>
(possibly in combination with <code>data</code> or <code>by</code>, e.g.
<code>estimate_link(model, by = "predictor")</code>). Other <code>predict</code> options will
return predicted values of the outcome for the full data, not stratified by
class membership.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/">modelbased</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Linear Models</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get predicted and prediction interval (see insight::get_predicted)</span></span></span>
<span class="r-in"><span><span class="fu">estimate_expectation</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | Predicted |   SE |         95% CI | Residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.62 |     23.28 | 0.63 | [21.99, 24.58] |     -2.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.88 |     21.92 | 0.57 | [20.75, 23.09] |     -0.92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.32 |     24.89 | 0.74 | [23.38, 26.39] |     -2.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.21 |     20.10 | 0.54 | [19.00, 21.20] |      1.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |     18.90 | 0.55 | [17.77, 20.03] |     -0.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.46 |     18.79 | 0.56 | [17.66, 19.93] |     -0.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.57 |     18.21 | 0.57 | [17.03, 19.38] |     -3.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.19 |     20.24 | 0.54 | [19.14, 21.34] |      4.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.15 |     20.45 | 0.54 | [19.35, 21.55] |      2.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |     18.90 | 0.55 | [17.77, 20.03] |      0.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |     18.90 | 0.55 | [17.77, 20.03] |     -1.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.07 |     15.53 | 0.72 | [14.06, 17.00] |      0.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.73 |     17.35 | 0.61 | [16.10, 18.60] |     -0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.78 |     17.08 | 0.62 | [15.81, 18.36] |     -1.88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.25 |      9.23 | 1.26 | [ 6.66, 11.80] |      1.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |      8.30 | 1.35 | [ 5.55, 11.05] |      2.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.34 |      8.72 | 1.31 | [ 6.05, 11.39] |      5.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.20 |     25.53 | 0.78 | [23.93, 27.13] |      6.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.61 |     28.65 | 1.05 | [26.52, 30.79] |      1.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.83 |     27.48 | 0.94 | [25.55, 29.40] |      6.42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.46 |     24.11 | 0.68 | [22.72, 25.51] |     -2.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.52 |     18.47 | 0.56 | [17.32, 19.63] |     -2.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |     18.93 | 0.55 | [17.80, 20.05] |     -3.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.84 |     16.76 | 0.64 | [15.45, 18.07] |     -3.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.85 |     16.74 | 0.64 | [15.42, 18.05] |      2.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.94 |     26.94 | 0.90 | [25.11, 28.77] |      0.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.14 |     25.85 | 0.81 | [24.20, 27.50] |      0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |     29.20 | 1.09 | [26.96, 31.43] |      1.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.17 |     20.34 | 0.54 | [19.24, 21.44] |     -4.54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.77 |     22.48 | 0.59 | [21.27, 23.69] |     -2.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.57 |     18.21 | 0.57 | [17.03, 19.38] |     -3.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.78 |     22.43 | 0.59 | [21.22, 23.64] |     -1.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get expected values with confidence interval</span></span></span>
<span class="r-in"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">estimate_relation</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | Predicted |   SE |         95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |     29.20 | 1.09 | [26.96, 31.43]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.95 |     26.87 | 0.89 | [25.05, 28.69]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.38 |     24.55 | 0.71 | [23.10, 26.01]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.82 |     22.23 | 0.58 | [21.04, 23.42]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.25 |     19.91 | 0.54 | [18.81, 21.01]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.69 |     17.59 | 0.60 | [16.36, 18.81]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.12 |     15.27 | 0.74 | [13.76, 16.77]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.55 |     12.94 | 0.92 | [11.06, 14.82]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.99 |     10.62 | 1.13 | [ 8.32, 12.92]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |      8.30 | 1.35 | [ 5.55, 11.05]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors modulated: wt</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualisation (see visualisation_recipe())</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="estimate_expectation-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Standardize predictions</span></span></span>
<span class="r-in"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">estimate_relation</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">am</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/datawizard/reference/standardize.html" class="external-link">standardize</a></span><span class="op">(</span><span class="va">pred</span>, include_response <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions (standardized)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt    |    am | Predicted |   SE |         95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.74 | -0.81 |     29.22 | 1.91 | [25.31, 33.14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.30 | -0.81 |     26.89 | 1.60 | [23.62, 30.17]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.85 | -0.81 |     24.57 | 1.30 | [21.90, 27.24]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.41 | -0.81 |     22.24 | 1.03 | [20.13, 24.36]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.03  | -0.81 |     19.92 | 0.82 | [18.24, 21.60]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.48  | -0.81 |     17.59 | 0.71 | [16.13, 19.05]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.92  | -0.81 |     15.27 | 0.76 | [13.71, 16.83]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.37  | -0.81 |     12.94 | 0.94 | [11.01, 14.87]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.81  | -0.81 |     10.62 | 1.20 | [ 8.17, 13.06]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.26  | -0.81 |      8.29 | 1.49 | [ 5.25, 11.33]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.74 |  1.19 |     29.20 | 1.11 | [26.92, 31.48]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.30 |  1.19 |     26.87 | 0.93 | [24.96, 28.78]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.85 |  1.19 |     24.55 | 0.86 | [22.79, 26.31]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.41 |  1.19 |     22.22 | 0.92 | [20.34, 24.09]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.03  |  1.19 |     19.90 | 1.08 | [17.68, 22.11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.48  |  1.19 |     17.57 | 1.32 | [14.86, 20.27]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.92  |  1.19 |     15.24 | 1.60 | [11.98, 18.51]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.37  |  1.19 |     12.92 | 1.90 | [ 9.04, 16.79]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.81  |  1.19 |     10.59 | 2.21 | [ 6.08, 15.11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.26  |  1.19 |      8.26 | 2.53 | [ 3.10, 13.43]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors modulated: wt, am</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/standardize.html" class="external-link">unstandardize</a></span><span class="op">(</span><span class="va">z</span>, include_response <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions (standardized)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | am | Predicted |   SE |         95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |  0 |     29.22 | 1.91 | [25.31, 33.14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.95 |  0 |     26.89 | 1.60 | [23.62, 30.17]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.38 |  0 |     24.57 | 1.30 | [21.90, 27.24]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.82 |  0 |     22.24 | 1.03 | [20.13, 24.36]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.25 |  0 |     19.92 | 0.82 | [18.24, 21.60]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.69 |  0 |     17.59 | 0.71 | [16.13, 19.05]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.12 |  0 |     15.27 | 0.76 | [13.71, 16.83]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.55 |  0 |     12.94 | 0.94 | [11.01, 14.87]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.99 |  0 |     10.62 | 1.20 | [ 8.17, 13.06]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |  0 |      8.29 | 1.49 | [ 5.25, 11.33]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |  1 |     29.20 | 1.11 | [26.92, 31.48]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.95 |  1 |     26.87 | 0.93 | [24.96, 28.78]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.38 |  1 |     24.55 | 0.86 | [22.79, 26.31]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.82 |  1 |     22.22 | 0.92 | [20.34, 24.09]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.25 |  1 |     19.90 | 1.08 | [17.68, 22.11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.69 |  1 |     17.57 | 1.32 | [14.86, 20.27]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.12 |  1 |     15.24 | 1.60 | [11.98, 18.51]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.55 |  1 |     12.92 | 1.90 | [ 9.04, 16.79]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.99 |  1 |     10.59 | 2.21 | [ 6.08, 15.11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |  1 |      8.26 | 2.53 | [ 3.10, 13.43]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors modulated: wt, am</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Logistic Models</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">vs</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">estimate_expectation</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | Predicted |   SE |       95% CI | Residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.62 |      0.67 | 0.12 | [0.40, 0.86] |     -0.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.88 |      0.56 | 0.12 | [0.33, 0.76] |     -0.56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.32 |      0.78 | 0.12 | [0.47, 0.94] |      0.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.21 |      0.39 | 0.11 | [0.21, 0.61] |      0.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |      0.30 | 0.11 | [0.14, 0.53] |     -0.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.46 |      0.29 | 0.10 | [0.13, 0.53] |      0.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.57 |      0.25 | 0.10 | [0.10, 0.50] |     -0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.19 |      0.41 | 0.11 | [0.22, 0.62] |      0.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.15 |      0.42 | 0.11 | [0.24, 0.64] |      0.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |      0.30 | 0.11 | [0.14, 0.53] |      0.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |      0.30 | 0.11 | [0.14, 0.53] |      0.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.07 |      0.11 | 0.08 | [0.02, 0.39] |     -0.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.73 |      0.20 | 0.10 | [0.07, 0.46] |     -0.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.78 |      0.18 | 0.10 | [0.06, 0.45] |     -0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.25 |      0.01 | 0.02 | [0.00, 0.24] |     -0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |  9.49e-03 | 0.02 | [0.00, 0.23] | -9.49e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.34 |      0.01 | 0.02 | [0.00, 0.23] |     -0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.20 |      0.82 | 0.12 | [0.49, 0.96] |      0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.61 |      0.93 | 0.07 | [0.58, 0.99] |      0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.83 |      0.90 | 0.09 | [0.55, 0.99] |      0.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.46 |      0.73 | 0.13 | [0.44, 0.91] |      0.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.52 |      0.27 | 0.10 | [0.11, 0.51] |     -0.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |      0.30 | 0.11 | [0.14, 0.53] |     -0.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.84 |      0.16 | 0.10 | [0.05, 0.43] |     -0.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.85 |      0.16 | 0.10 | [0.05, 0.43] |     -0.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.94 |      0.88 | 0.10 | [0.54, 0.98] |      0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.14 |      0.84 | 0.11 | [0.50, 0.96] |     -0.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |      0.94 | 0.07 | [0.60, 0.99] |      0.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.17 |      0.42 | 0.11 | [0.23, 0.63] |     -0.42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.77 |      0.60 | 0.12 | [0.36, 0.80] |     -0.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.57 |      0.25 | 0.10 | [0.10, 0.50] |     -0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.78 |      0.60 | 0.12 | [0.36, 0.80] |      0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: vs</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictions are on the response-scale.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">estimate_relation</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | Predicted |   SE |       95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |      0.94 | 0.07 | [0.60, 0.99]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.95 |      0.88 | 0.10 | [0.53, 0.98]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.38 |      0.76 | 0.12 | [0.46, 0.92]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.82 |      0.58 | 0.12 | [0.35, 0.78]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.25 |      0.38 | 0.11 | [0.20, 0.60]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.69 |      0.21 | 0.10 | [0.07, 0.47]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.12 |      0.10 | 0.08 | [0.02, 0.38]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.55 |      0.05 | 0.05 | [0.01, 0.32]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.99 |      0.02 | 0.03 | [0.00, 0.27]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |  9.49e-03 | 0.02 | [0.00, 0.23]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: vs</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors modulated: wt</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictions are on the response-scale.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixed models</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">gear</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html" class="external-link">glmmTMB</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">gear</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">estimate_expectation</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | gear | Predicted |   SE |         95% CI | Residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.62 | 4    |     23.64 | 1.08 | [21.53, 25.76] |     -2.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.88 | 4    |     22.32 | 1.13 | [20.11, 24.53] |     -1.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.32 | 4    |     25.20 | 1.05 | [23.14, 27.26] |     -2.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.21 | 3    |     19.87 | 0.81 | [18.28, 21.46] |      1.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 | 3    |     18.70 | 0.75 | [17.23, 20.18] | -1.00e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.46 | 3    |     18.60 | 0.75 | [17.13, 20.06] |     -0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.57 | 3    |     18.03 | 0.73 | [16.60, 19.46] |     -3.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.19 | 4    |     20.68 | 1.22 | [18.29, 23.08] |      3.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.15 | 4    |     20.89 | 1.21 | [18.52, 23.26] |      1.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 | 4    |     19.39 | 1.32 | [16.80, 21.97] |     -0.19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 | 4    |     19.39 | 1.32 | [16.80, 21.97] |     -1.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.07 | 3    |     15.43 | 0.74 | [13.98, 16.88] |      0.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.73 | 3    |     17.19 | 0.72 | [15.79, 18.60] |      0.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.78 | 3    |     16.94 | 0.71 | [15.54, 18.34] |     -1.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.25 | 3    |      9.30 | 1.21 | [ 6.93, 11.67] |      1.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 | 3    |      8.40 | 1.30 | [ 5.84, 10.95] |      2.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.34 | 3    |      8.81 | 1.26 | [ 6.34, 11.28] |      5.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.20 | 4    |     25.83 | 1.05 | [23.77, 27.88] |      6.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.61 | 4    |     28.86 | 1.13 | [26.64, 31.08] |      1.54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.83 | 4    |     27.72 | 1.09 | [25.59, 29.85] |      6.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.46 | 3    |     23.76 | 1.14 | [21.53, 26.00] |     -2.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.52 | 3    |     18.29 | 0.74 | [16.84, 19.73] |     -2.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 | 3    |     18.73 | 0.75 | [17.25, 20.20] |     -3.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.84 | 3    |     16.62 | 0.71 | [15.22, 18.02] |     -3.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.85 | 3    |     16.60 | 0.72 | [15.20, 18.00] |      2.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.94 | 4    |     27.20 | 1.07 | [25.10, 29.30] |      0.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.14 | 5    |     25.30 | 1.61 | [22.15, 28.45] |      0.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 | 5    |     28.56 | 1.92 | [24.78, 32.33] |      1.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.17 | 5    |     19.95 | 1.24 | [17.53, 22.37] |     -4.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.77 | 5    |     22.03 | 1.35 | [19.38, 24.68] |     -2.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.57 | 5    |     17.87 | 1.17 | [15.58, 20.17] |     -2.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.78 | 4    |     22.81 | 1.11 | [20.64, 24.98] |     -1.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">estimate_relation</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | Predicted |   SE |             CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |     28.89 | 1.35 | [26.23, 31.54]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.95 |     26.63 | 1.11 | [24.45, 28.80]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.38 |     24.37 | 0.89 | [22.63, 26.12]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.82 |     22.11 | 0.73 | [20.69, 23.54]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.25 |     19.86 | 0.66 | [18.57, 21.15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.69 |     17.60 | 0.71 | [16.21, 18.99]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.12 |     15.35 | 0.86 | [13.66, 17.04]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.55 |     13.09 | 1.07 | [10.98, 15.19]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.99 |     10.83 | 1.32 | [ 8.26, 13.41]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |      8.57 | 1.57 | [ 5.49, 11.66]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors modulated: wt</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict random effects and calculate contrasts</span></span></span>
<span class="r-in"><span><span class="va">estim</span> <span class="op">&lt;-</span> <span class="fu">estimate_relation</span><span class="op">(</span><span class="va">model</span>, by <span class="op">=</span> <span class="st">"gear"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">estim</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gear | Predicted |   SE |         95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    |     19.86 | 0.81 | [18.27, 21.45]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    |     20.54 | 1.23 | [18.13, 22.96]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    |     19.71 | 1.22 | [17.30, 22.11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors modulated: gear</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors controlled: wt (3.2)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">estim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Contrasts Analysis</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level1 | Level2 | Difference |   SE |        95% CI | Statistic |     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      | 4      |      -0.68 | 1.48 | [-3.58, 2.21] |     -0.46 | 0.643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      | 5      |       0.15 | 1.47 | [-2.73, 3.03] |      0.10 | 0.917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      | 5      |       0.84 | 1.74 | [-2.57, 4.24] |      0.48 | 0.630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors contrasted: gear</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors averaged: wt (3.2)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bayesian models</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu">rstanarm</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">mtcars</span>, refresh <span class="op">=</span> <span class="fl">0</span>, iter <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">estimate_expectation</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | Predicted |   SE |         95% CI | Residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.62 |     23.12 | 0.62 | [21.85, 24.24] |     -2.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.88 |     21.78 | 0.55 | [20.72, 22.78] |     -0.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.32 |     24.70 | 0.74 | [23.16, 25.98] |     -1.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.21 |     19.99 | 0.51 | [19.10, 20.91] |      1.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |     18.80 | 0.53 | [17.82, 19.78] |     -0.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.46 |     18.70 | 0.53 | [17.70, 19.68] |     -0.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.57 |     18.12 | 0.55 | [17.06, 19.19] |     -3.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.19 |     20.12 | 0.51 | [19.24, 21.04] |      4.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.15 |     20.33 | 0.52 | [19.44, 21.26] |      2.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |     18.80 | 0.53 | [17.82, 19.78] |      0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |     18.80 | 0.53 | [17.82, 19.78] |     -1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.07 |     15.48 | 0.72 | [14.08, 16.91] |      0.92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.73 |     17.27 | 0.59 | [16.12, 18.42] |      0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.78 |     17.01 | 0.61 | [15.81, 18.19] |     -1.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.25 |      9.27 | 1.30 | [ 6.80, 11.85] |      1.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |      8.35 | 1.39 | [ 5.69, 11.14] |      2.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.34 |      8.77 | 1.35 | [ 6.19, 11.48] |      5.93</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.20 |     25.34 | 0.79 | [23.64, 26.71] |      7.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.61 |     28.42 | 1.07 | [26.12, 30.36] |      1.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.83 |     27.26 | 0.96 | [25.18, 28.99] |      6.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.46 |     23.94 | 0.68 | [22.52, 25.14] |     -2.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.52 |     18.38 | 0.54 | [17.35, 19.41] |     -2.88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.44 |     18.83 | 0.53 | [17.85, 19.81] |     -3.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.84 |     16.70 | 0.63 | [15.46, 17.91] |     -3.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.85 |     16.67 | 0.63 | [15.43, 17.89] |      2.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.94 |     26.73 | 0.91 | [24.75, 28.41] |      0.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.14 |     25.65 | 0.82 | [23.87, 27.10] |      0.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |     28.96 | 1.13 | [26.56, 30.97] |      1.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.17 |     20.23 | 0.52 | [19.33, 21.14] |     -4.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.77 |     22.33 | 0.58 | [21.24, 23.38] |     -2.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.57 |     18.12 | 0.55 | [17.06, 19.19] |     -3.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.78 |     22.28 | 0.58 | [21.20, 23.32] |     -0.88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">estimate_relation</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Model-based Predictions</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wt   | Predicted |   SE |         95% CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.51 |     28.96 | 1.13 | [26.56, 30.97]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.95 |     26.66 | 0.91 | [24.69, 28.33]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.38 |     24.38 | 0.71 | [22.87, 25.62]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.82 |     22.09 | 0.57 | [21.01, 23.11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.25 |     19.80 | 0.51 | [18.89, 20.71]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.69 |     17.51 | 0.58 | [16.38, 18.62]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.12 |     15.22 | 0.74 | [13.78, 16.69]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.55 |     12.93 | 0.94 | [11.12, 14.76]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.99 |     10.64 | 1.16 | [ 8.44, 12.90]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.42 |      8.35 | 1.39 | [ 5.69, 11.14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Variable predicted: mpg</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">Predictors modulated: wt</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="https://remi-theriault.com/" class="external-link">Rémi Thériault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

