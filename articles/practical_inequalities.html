<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Case Study: Measuring and comparing absolute and relative inequalities in R • modelbased</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case Study: Measuring and comparing absolute and relative inequalities in R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-introductions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Introductions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-introductions">
<li><a class="dropdown-item" href="../articles/overview_of_vignettes.html">Overview of Vignettes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_models.html">Mixed effects models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpretation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_response.html">Use a model to make predictions</a></li>
    <li><a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualization</h6></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_relation.html">Visualize effects and interactions</a></li>
    <li><a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies">
<li><h6 class="dropdown-header" data-toc-skip>Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/workflow_modelbased.html">Understanding your models</a></li>
    <li><a class="dropdown-item" href="../articles/practical_causality.html">Causal inference for observational data</a></li>
    <li><a class="dropdown-item" href="../articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a></li>
    <li><a class="dropdown-item" href="../articles/practical_inequalities.html">Measuring and comparing absolute and relative inequalities</a></li>
    <li><a class="dropdown-item" href="../articles/practical_its.html">Interrupted Time Series Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/practical_growthmixture.html">An Introduction to Growth Mixture Models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Contrasts</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_1.html">Contrasts and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_2.html">User Defined Contrasts and Joint Tests</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_3.html">Slopes, floodlight and spotlight analysis (Johnson-Neyman intervals)</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_4.html">Contrasts and comparisons for generalized linear models</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_5.html">Contrasts and comparisons for zero-inflation models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats">
<li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Case Study: Measuring and comparing absolute and relative inequalities in R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/main/vignettes/practical_inequalities.Rmd" class="external-link"><code>vignettes/practical_inequalities.Rmd</code></a></small>
      <div class="d-none name"><code>practical_inequalities.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-why-summarize-effects">1. Introduction: Why Summarize Effects?<a class="anchor" aria-label="anchor" href="#introduction-why-summarize-effects"></a>
</h2>
<p>In the social sciences, many key variables are nominal (like race or
gender) or ordinal (such as education level or social class).
Understanding the total impact of these variables can be tricky because
they consist of multiple categories. For instance, to determine if
educational attainment affects quality of life, we must consider several
comparisons, such as low vs. mid, low vs. high, and mid vs. high
education levels</p>
<p>This is where <em>inequality measures</em> come in handy. They are
summary statistics that encapsulate the overall effect of a nominal or
ordinal variable. The fundamental concept is that a variable’s effect
size is proportional to the outcome disparities it generates. As Mize
and Han (2025) propose, we can think of the overall effect of a
categorical variable in terms of the <strong>inequality</strong> it
produces in the outcome. A variable has a large effect if the outcomes
for its different groups are far apart, and a small effect if the
outcomes are similar.</p>
<p>This vignette demonstrates how to compute two such summary measures -
<strong>absolute inequality</strong> and <strong>relative
inequality</strong> - using the <code>modelbased</code> package in R,
which is part of the <code>easystats</code> ecosystem.</p>
</div>
<div class="section level2">
<h2 id="the-modelbased-package-and-the-example">2. The <code>modelbased</code> Package and the Example<a class="anchor" aria-label="anchor" href="#the-modelbased-package-and-the-example"></a>
</h2>
<p>The <code>modelbased</code> package provides a consistent and
easy-to-use framework for obtaining model-based predictions, means,
contrasts, and slopes. We will use its functions to calculate inequality
measures.</p>
<div class="section level3">
<h3 id="required-packages">Required Packages<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h3>
<p>First, let’s load the necessary libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/easystats/" class="external-link">easystats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-data-quality-of-life-for-cancer-patients">Example Data: Quality of Life for Cancer Patients<a class="anchor" aria-label="anchor" href="#example-data-quality-of-life-for-cancer-patients"></a>
</h3>
<p>We will use the <code>qol_cancer</code> dataset, which is included in
the <code>parameters</code> package. This dataset contains information
on the Quality of Life (QoL) for patients with prostate cancer, measured
at three different time points. It also includes the patients’ education
level, a key socioeconomic variable.</p>
<p>Our goal is to compute absolute and relative inequality measures for
the <code>education</code> variable to understand its overall impact on
patients’ QoL.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">qol_cancer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The 'ID' variable should be a factor for the model, but we'll make it numeric</span></span>
<span><span class="co"># for a later example of splitting the data.</span></span>
<span><span class="va">qol_cancer</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">qol_cancer</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">qol_cancer</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID      QoL time  age  phq4 hospital education</span></span>
<span><span class="co">#&gt; 1  1 41.66667    3 -3.6  7.16        1       mid</span></span>
<span><span class="co">#&gt; 2  1 41.66667    1 -3.6  8.55        1       mid</span></span>
<span><span class="co">#&gt; 3  1 33.33333    2 -3.6  3.28        1       mid</span></span>
<span><span class="co">#&gt; 4  9 83.33333    1  1.4 -2.45        1       mid</span></span>
<span><span class="co">#&gt; 5  9 83.33333    2  1.4 -1.72        1       mid</span></span>
<span><span class="co">#&gt; 6  9 83.33333    3  1.4 -1.84        1       mid</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modeling-and-visualizing-the-data">3. Modeling and Visualizing the Data<a class="anchor" aria-label="anchor" href="#modeling-and-visualizing-the-data"></a>
</h2>
<p>We begin by fitting a linear model to predict Quality of Life
(<code>QoL</code>) based on <code>time</code>, <code>education</code>,
and their interaction. This allows the effect of education to vary over
time.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a linear model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">QoL</span> <span class="op">~</span> <span class="va">time</span> <span class="op">*</span> <span class="va">education</span>, data <span class="op">=</span> <span class="va">qol_cancer</span><span class="op">)</span></span></code></pre></div>
<p>Before calculating inequality, let’s visualize the estimated marginal
means from our model. This plot shows how the average QoL changes over
time for each education level. We can see clear gaps between the
groups.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get estimated marginal means for each combination of time and education</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_means.html">estimate_means</a></span><span class="op">(</span><span class="va">m</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the means</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="practical_inequalities_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<p>The plot shows that individuals with higher education report a higher
QoL, and these gaps appear to widen over time. Our inequality measures
will quantify this “average gap.”</p>
</div>
<div class="section level2">
<h2 id="absolute-inequality">4. Absolute Inequality<a class="anchor" aria-label="anchor" href="#absolute-inequality"></a>
</h2>
<p><strong>Absolute inequality</strong> is the average of all absolute
differences between the predicted outcomes for each pair of groups. It
answers the question: “On average, how many units does the outcome
differ between any two education groups?”</p>
<div class="section level3">
<h3 id="pairwise-contrasts">Pairwise Contrasts<a class="anchor" aria-label="anchor" href="#pairwise-contrasts"></a>
</h3>
<p>First, let’s look at the simple pairwise differences, averaged across
the three time points.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the average difference between each pair of education levels</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m</span>, contrast <span class="op">=</span> <span class="st">"education"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Contrasts Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Level1 | Level2 |     Difference (CI) |      p</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span>
<span><span class="co">#&gt; mid    | low    |  8.82 (4.58, 13.06) | &lt;0.001</span></span>
<span><span class="co">#&gt; high   | low    | 14.46 (9.65, 19.27) | &lt;0.001</span></span>
<span><span class="co">#&gt; high   | mid    |  5.64 (1.83,  9.44) |  0.004</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; Predictors averaged: time (2)</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
<p>This table shows three specific comparisons. To get a single summary
measure, we can compute the mean of these differences.</p>
</div>
<div class="section level3">
<h3 id="calculating-absolute-inequality">Calculating Absolute Inequality<a class="anchor" aria-label="anchor" href="#calculating-absolute-inequality"></a>
</h3>
<p>The <code><a href="../reference/estimate_contrasts.html">estimate_contrasts()</a></code> function can directly compute
the absolute inequality by setting
<code>comparison = "inequality"</code>. This calculates the mean of the
absolute values of all pairwise differences.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the absolute inequality for the 'education' variable</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m</span>, contrast <span class="op">=</span> <span class="st">"education"</span>, comparison <span class="op">=</span> <span class="st">"inequality"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Inequality Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter | Mean Difference (CI) |      p</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; education |   9.64 (6.44, 12.84) | &lt;0.001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
<p><strong>Interpretation</strong>: The mean difference (absolute
inequality) is <strong>9.64</strong>. This means that, on average, the
Quality of Life score differs by 9.64 points between any two randomly
chosen education levels, after accounting for time. The small p-value
(<code>p &lt; .001</code>) indicates that this overall inequality is
statistically significant.</p>
</div>
</div>
<div class="section level2">
<h2 id="relative-inequality">5. Relative Inequality<a class="anchor" aria-label="anchor" href="#relative-inequality"></a>
</h2>
<p><strong>Relative inequality</strong> (or the inequality ratio) is the
average of the ratios of predicted outcomes between all pairs of groups.
It answers the question: “On average, by what factor does the outcome
differ between any two education groups?” This is particularly useful
when the scale of the outcome is not intrinsically meaningful or when
comparing effects across different outcomes.</p>
<div class="section level3">
<h3 id="pairwise-ratios">Pairwise Ratios<a class="anchor" aria-label="anchor" href="#pairwise-ratios"></a>
</h3>
<p>First, let’s look at the pairwise ratios.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the ratio of means for each pair of education levels</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m</span>, contrast <span class="op">=</span> <span class="st">"education"</span>, ratio <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Contrasts Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Level1 | Level2 |     Difference (CI) |      p</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span>
<span><span class="co">#&gt; mid    | low    |  8.82 (4.58, 13.06) | &lt;0.001</span></span>
<span><span class="co">#&gt; high   | low    | 14.46 (9.65, 19.27) | &lt;0.001</span></span>
<span><span class="co">#&gt; high   | mid    |  5.64 (1.83,  9.44) |  0.004</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; Predictors averaged: time (2)</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculating-the-inequality-ratio">Calculating the Inequality Ratio<a class="anchor" aria-label="anchor" href="#calculating-the-inequality-ratio"></a>
</h3>
<p>We set <code>comparison = "inequality_ratio"</code> to get the
summary measure.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the relative inequality (inequality ratio)</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m</span>, contrast <span class="op">=</span> <span class="st">"education"</span>, comparison <span class="op">=</span> <span class="st">"inequality_ratio"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Inequality Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter |   Mean Ratio (CI) |      p</span></span>
<span><span class="co">#&gt; --------------------------------------</span></span>
<span><span class="co">#&gt; custom    | 1.14 (1.09, 1.20) | &lt;0.001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
<p><strong>Interpretation</strong>: The mean ratio (relative inequality)
is <strong>1.14</strong>. This means that, on average, the QoL score is
1.14 times higher (or 14% higher) when comparing a higher education
group to a lower one.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparing-inequalities-across-groups-and-time">6. Comparing Inequalities Across Groups and Time<a class="anchor" aria-label="anchor" href="#comparing-inequalities-across-groups-and-time"></a>
</h2>
<p>A powerful application of these measures is to compare how inequality
differs across different subgroups or conditions.</p>
<div class="section level3">
<h3 id="comparing-inequality-across-subgroups">Comparing Inequality Across Subgroups<a class="anchor" aria-label="anchor" href="#comparing-inequality-across-subgroups"></a>
</h3>
<p>Let’s randomly split our data into two groups based on patient
<code>ID</code> to simulate comparing inequality between, for example,
two different treatment centers or demographic groups.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Split data and fit separate models</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">QoL</span> <span class="op">~</span> <span class="va">time</span> <span class="op">*</span> <span class="va">education</span>, data <span class="op">=</span> <span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_match.html" class="external-link">data_filter</a></span><span class="op">(</span><span class="va">qol_cancer</span>, <span class="va">ID</span> <span class="op">&lt;</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">QoL</span> <span class="op">~</span> <span class="va">time</span> <span class="op">*</span> <span class="va">education</span>, data <span class="op">=</span> <span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_match.html" class="external-link">data_filter</a></span><span class="op">(</span><span class="va">qol_cancer</span>, <span class="va">ID</span> <span class="op">&gt;=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the patterns in each group</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/estimate_means.html">estimate_means</a></span><span class="op">(</span><span class="va">m1</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Group 1 (ID &lt; 100)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/estimate_means.html">estimate_means</a></span><span class="op">(</span><span class="va">m2</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Group 2 (ID &gt;= 100)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show plots side-by-side</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="practical_inequalities_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
<p>The visual gap between education levels appears larger in Group 1.
Let’s confirm this by calculating the absolute inequality for each
group.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Absolute inequality in Group 1</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m1</span>, contrast <span class="op">=</span> <span class="st">"education"</span>, comparison <span class="op">=</span> <span class="st">"inequality"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Inequality Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter | Mean Difference (CI) |      p</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; education |  11.05 (6.72, 15.38) | &lt;0.001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span>
<span></span>
<span><span class="co"># Absolute inequality in Group 2</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m2</span>, contrast <span class="op">=</span> <span class="st">"education"</span>, comparison <span class="op">=</span> <span class="st">"inequality"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Inequality Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter | Mean Difference (CI) |     p</span></span>
<span><span class="co">#&gt; ----------------------------------------</span></span>
<span><span class="co">#&gt; education |   7.27 (2.66, 11.89) | 0.002</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
<p>As suspected, the absolute inequality in QoL due to education is
larger in Group 1 (Mean Difference = 11.05) than in Group 2 (Mean
Difference = 7.27). This demonstrates how these measures can be used to
formally test for differences in inequality across populations.</p>
<p>We can even test if the difference in absolute inequality between the
two groups is statistically significant.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a new variable to distinguish groups</span></span>
<span><span class="va">qol_cancer</span><span class="op">$</span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">qol_cancer</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;</span> <span class="fl">100</span>, <span class="st">"Group 1"</span>, <span class="st">"Group 2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># fit a model with the group variable</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">QoL</span> <span class="op">~</span> <span class="va">time</span> <span class="op">*</span> <span class="va">education</span> <span class="op">*</span> <span class="va">grp</span>, data <span class="op">=</span> <span class="va">qol_cancer</span><span class="op">)</span></span>
<span><span class="co"># Estimate the absolute inequality for each group, and compare them</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"education"</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"grp"</span>,</span>
<span>  comparison <span class="op">=</span> <span class="st">"inequality_pairwise"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Inequality Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter         | Mean Difference (CI) |     p</span></span>
<span><span class="co">#&gt; ------------------------------------------------</span></span>
<span><span class="co">#&gt; Group 1 - Group 2 |  3.77 (-2.56, 10.11) | 0.243</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
<p>As can be seen, the mean difference in absolute inequality between
the two groups is 3.77, however, th p-value indicate that this
difference is not statistically significant - the absolute inequalities
in education are not significantly different between the two groups.</p>
</div>
<div class="section level3">
<h3 id="tracking-inequality-over-time">Tracking Inequality Over Time<a class="anchor" aria-label="anchor" href="#tracking-inequality-over-time"></a>
</h3>
<p>Our model includes an interaction between <code>time</code> and
<code>education</code>, suggesting the inequality might be changing. We
can examine the <em>trend</em> in inequality by contrasting the slopes
of the <code>time</code> variable across the different
<code>education</code> groups.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the slope of 'time' for each education level in the first group</span></span>
<span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">m1</span>, trend <span class="op">=</span> <span class="st">"time"</span>, by <span class="op">=</span> <span class="st">"education"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated Marginal Effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; education |            Slope (CI) |      p</span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; low       | -6.71 (-12.99, -0.44) |  0.036</span></span>
<span><span class="co">#&gt; mid       |  0.40 ( -3.29,  4.09) |  0.831</span></span>
<span><span class="co">#&gt; high      |  0.00 ( -4.95,  4.95) | &gt; .999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal effects estimated for time</span></span>
<span><span class="co">#&gt; Type of slope was dY/dX</span></span>
<span></span>
<span><span class="co"># And for the second group</span></span>
<span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">m2</span>, trend <span class="op">=</span> <span class="st">"time"</span>, by <span class="op">=</span> <span class="st">"education"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated Marginal Effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; education |          Slope (CI) |     p</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt; low       | 3.24 (-2.93,  9.41) | 0.302</span></span>
<span><span class="co">#&gt; mid       | 1.72 (-1.95,  5.38) | 0.358</span></span>
<span><span class="co">#&gt; high      | 6.04 ( 0.19, 11.90) | 0.043</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal effects estimated for time</span></span>
<span><span class="co">#&gt; Type of slope was dY/dX</span></span></code></pre></div>
<p>In Group 1, the QoL for the ‘low’ education group is decreasing over
time (Slope = -6.71), while it is stable for the ‘mid’ and ‘high’
groups. This suggests the gap is widening. We can quantify this change
in inequality directly.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the inequality in the *slopes* of time</span></span>
<span><span class="co"># This tells us if the rate of change in QoL is unequal across groups</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span></span>
<span>  <span class="va">m1</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"education"</span>,</span>
<span>  comparison <span class="op">=</span> <span class="st">"inequality"</span>,</span>
<span>  integer_as_numeric <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Inequality Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter | Mean Difference (CI) |     p</span></span>
<span><span class="co">#&gt; ----------------------------------------</span></span>
<span><span class="co">#&gt; time      |   4.74 (-0.09, 9.58) | 0.055</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: time</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span>
<span></span>
<span><span class="co"># How does it compare to Group 2?</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span></span>
<span>  <span class="va">m2</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"education"</span>,</span>
<span>  comparison <span class="op">=</span> <span class="st">"inequality"</span>,</span>
<span>  integer_as_numeric <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Inequality Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter | Mean Difference (CI) |     p</span></span>
<span><span class="co">#&gt; ----------------------------------------</span></span>
<span><span class="co">#&gt; time      |   2.88 (-1.70, 7.47) | 0.217</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: time</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
<p>The mean difference in slopes is 4.74. This indicates that the rate
of change in QoL differs, on average, by 4.74 points per unit of time
between any two categories of the education groups. Inequalities are
smaller in Group 2 (Mean Difference = 2.88), suggesting a more uniform
change over time.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">7. Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>modelbased</code> package offers a powerful and intuitive
way to move beyond simple pairwise comparisons and summarize the
holistic effect of categorical variables. By quantifying
<strong>absolute and relative inequalities</strong>, researchers
can:</p>
<ul>
<li>Obtain a single, interpretable effect size for a nominal or ordinal
predictor.</li>
<li>Formally test whether this overall effect is statistically
significant.</li>
<li>Compare the magnitude of inequality across different groups, models,
or over time.</li>
</ul>
<p>This approach aligns statistical practice with the theoretical
concept of group-based disparities, providing a clearer and more
comprehensive understanding of how social categories shape outcomes.</p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Mize, T. D., &amp; Han, B. (2025). Inequality and Total Effect
Summary Measures for Nominal and Ordinal Variables. <em>Sociological
Science, 12</em>, 115-157.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="https://remi-theriault.com/" class="external-link">Rémi Thériault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
