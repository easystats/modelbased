<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An Introduction to Growth Mixture Models with brms and easystats • modelbased</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to Growth Mixture Models with brms and easystats">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-introductions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Introductions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-introductions">
<li><a class="dropdown-item" href="../articles/overview_of_vignettes.html">Overview of Vignettes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_models.html">Mixed effects models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpretation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_response.html">Use a model to make predictions</a></li>
    <li><a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualization</h6></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_relation.html">Visualize effects and interactions</a></li>
    <li><a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies">
<li><h6 class="dropdown-header" data-toc-skip>Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/workflow_modelbased.html">Understanding your models</a></li>
    <li><a class="dropdown-item" href="../articles/practical_causality.html">Causal inference for observational data</a></li>
    <li><a class="dropdown-item" href="../articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a></li>
    <li><a class="dropdown-item" href="../articles/practical_its.html">Interrupted Time Series Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/practical_growthmixture.html">An Introduction to Growth Mixture Models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Contrasts</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_1.html">Contrasts and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_2.html">User Defined Contrasts and Joint Tests</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_3.html">Slopes, floodlight and spotlight analysis (Johnson-Neyman intervals)</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_4.html">Contrasts and comparisons for generalized linear models</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_5.html">Contrasts and comparisons for zero-inflation models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats">
<li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An Introduction to Growth Mixture Models with brms and easystats</h1>
                        <h4 data-toc-skip class="author">The easystats
team</h4>
            
            <h4 data-toc-skip class="date">2025-07-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/main/vignettes/practical_growthmixture.Rmd" class="external-link"><code>vignettes/practical_growthmixture.Rmd</code></a></small>
      <div class="d-none name"><code>practical_growthmixture.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Growth Mixture Models (GMMs) are a powerful statistical technique
used to identify unobserved subgroups (latent classes) within a
population that exhibit different developmental trajectories over time.
They are a subclass of latent class analysis and are particularly useful
in longitudinal research to understand heterogeneity in how individuals
change.</p>
<p>This vignette demonstrates how to conduct a Growth Mixture Model
using the <code>brms</code> package for Bayesian modeling and the
<code>easystats</code> ecosystem (particularly <code>modelbased</code>,
<code>parameters</code>, and <code>see</code>) for easy interpretation
and visualization.</p>
</div>
<div class="section level2">
<h2 id="loading-packages-and-data">Loading Packages and Data<a class="anchor" aria-label="anchor" href="#loading-packages-and-data"></a>
</h2>
<p>First, we load the necessary packages. <code>brms</code> is for model
fitting, and <code>easystats</code> is a suite of packages that
simplifies the entire process of statistical analysis and
visualization.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/easystats/" class="external-link">easystats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="the-dataset">The Dataset<a class="anchor" aria-label="anchor" href="#the-dataset"></a>
</h3>
<p>We will use the <code>qol_cancer</code> dataset, which is included in
the <code>datawizard</code> package. This dataset contains longitudinal
data on the health-related quality of life (QoL) of cancer patients,
measured at three time points: pre-surgery, and 6 and 12 months
post-surgery.</p>
<p>The dataset includes the following variables:</p>
<ul>
<li>
<code>ID</code>: A unique identifier for each patient.</li>
<li>
<code>QoL</code>: The outcome variable, a Quality of Life
score.</li>
<li>
<code>time</code>: The measurement time point (1 = pre-surgery, 2 =
6 months, 3 = 12 months).</li>
<li>
<code>hospital</code>: The hospital where the operation was
performed.</li>
<li>
<code>education</code>: The patient’s education level (low, mid,
high).</li>
<li>
<code>age</code>: The patient’s age (standardized).</li>
</ul>
<p>Let’s prepare the data by converting the <code>time</code> and
<code>hospital</code> variables to factors.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">qol_cancer</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qol_cancer</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">qol_cancer</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">qol_cancer</span><span class="op">$</span><span class="va">hospital</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">qol_cancer</span><span class="op">$</span><span class="va">hospital</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="fitting-the-growth-mixture-model">Fitting the Growth Mixture Model<a class="anchor" aria-label="anchor" href="#fitting-the-growth-mixture-model"></a>
</h2>
<p>The core of a GMM in <code>brms</code> is the <code><a href="https://paulbuerkner.com/brms/reference/mixture.html" class="external-link">mixture()</a></code>
family, which allows us to model the outcome variable as a mixture of
distributions. In our case, we hypothesize that there are distinct
subgroups of patients with different QoL trajectories. We will fit a
model with two latent classes (<code>nmix = 2</code>).</p>
<p>The model formula
<code>QoL ~ time + hospital + education + age + (1 + time | ID)</code>
specifies that <code>QoL</code> is predicted by several fixed effects
(<code>time</code>, <code>hospital</code>, etc.) and a random effects
structure <code>(1 + time | ID)</code>. This random effects part is
crucial for growth models, as it allows each patient (<code>ID</code>)
to have their own baseline QoL (random intercept <code>1</code>) and
their own rate of change over time (random slope <code>time</code>).</p>
<div class="section level3">
<h3 id="running-the-model">Running the Model<a class="anchor" aria-label="anchor" href="#running-the-model"></a>
</h3>
<p>Fitting a Bayesian mixture model can be computationally intensive.
For the purposes of this vignette, we will download a pre-fitted model
from the <code>easystats</code> repository.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download the pre-fitted model</span></span>
<span><span class="va">brms_mixture_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/download_model.html" class="external-link">download_model</a></span><span class="op">(</span><span class="st">"brms_mixture_2"</span><span class="op">)</span></span></code></pre></div>
<p>If you wish to fit the model yourself, you can use the following
code. Be aware that it may take several minutes to run.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In case of convergence issues, specifying priors can help. The priors are</span></span>
<span><span class="co"># set for the population-level intercept of each mixture component (mu1, mu2).</span></span>
<span><span class="co"># prior &lt;- c(</span></span>
<span><span class="co">#   prior(normal(0, 10), class = Intercept, dpar = mu1),</span></span>
<span><span class="co">#   prior(normal(0, 10), class = Intercept, dpar = mu2)</span></span>
<span><span class="co"># )</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">brms_mixture_2</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">QoL</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">hospital</span> <span class="op">+</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">qol_cancer</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/mixture.html" class="external-link">mixture</a></span><span class="op">(</span><span class="va">gaussian</span>, nmix <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="co"># Gaussian mixture with 2 classes</span></span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,      <span class="co"># Number of MCMC chains</span></span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,     <span class="co"># Total iterations per chain</span></span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,       <span class="co"># Use 4 CPU cores</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,     <span class="co"># For reproducibility</span></span>
<span>  silent <span class="op">=</span> <span class="fl">2</span>,      <span class="co"># Suppress Stan progress</span></span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>You can use different factors to predict the outcome for each group
in your data. To do this, simply create a separate prediction formula
for each part of your model. For instance, you could use one set of
factors to predict the quality of life for “Group 1” and a different set
for “Group 2”. You can even use factors to predict which group someone
is likely to belong to. While this guide won’t cover the details, a code
example at the end shows you how.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-the-model">Interpreting the Model<a class="anchor" aria-label="anchor" href="#interpreting-the-model"></a>
</h2>
<p>With our model fitted, we can now use the <code>easystats</code>
functions to understand the results.</p>
<div class="section level3">
<h3 id="predicted-class-membership">Predicted Class Membership<a class="anchor" aria-label="anchor" href="#predicted-class-membership"></a>
</h3>
<p>Our first step is to determine which latent class each patient
belongs to at each time point. We can use the
<code><a href="../reference/estimate_expectation.html">estimate_prediction()</a></code> function from the
<code>modelbased</code> package with
<code>predict = "classification"</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_expectation.html">estimate_prediction</a></span><span class="op">(</span><span class="va">brms_mixture_2</span>, predict <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model-based Predictions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time | hospital | education |   age | ID | Predicted | Probability</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; 3    | 1        | mid       | -3.60 | 1  |      1.00 |        0.72</span></span>
<span><span class="co">#&gt; 1    | 1        | mid       | -3.60 | 1  |      2.00 |        0.51</span></span>
<span><span class="co">#&gt; 2    | 1        | mid       | -3.60 | 1  |      1.00 |        0.50</span></span>
<span><span class="co">#&gt; 1    | 1        | mid       |  1.40 | 10 |      2.00 |        0.97</span></span>
<span><span class="co">#&gt; 2    | 1        | mid       |  1.40 | 10 |      2.00 |        0.97</span></span>
<span><span class="co">#&gt; 3    | 1        | mid       |  1.40 | 10 |      2.00 |        0.97</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time |       95% CI | Residuals</span></span>
<span><span class="co">#&gt; -------------------------------</span></span>
<span><span class="co">#&gt; 3    | [0.00, 1.00] |     40.67</span></span>
<span><span class="co">#&gt; 1    | [0.00, 1.00] |     39.67</span></span>
<span><span class="co">#&gt; 2    | [0.00, 1.00] |     32.33</span></span>
<span><span class="co">#&gt; 1    | [0.86, 1.00] |     81.33</span></span>
<span><span class="co">#&gt; 2    | [0.85, 1.00] |     81.33</span></span>
<span><span class="co">#&gt; 3    | [0.89, 1.00] |     81.33</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictions are on the classification-scale.</span></span></code></pre></div>
<p>The output table shows the <code>Predicted</code> class for each
observation, along with the <code>Probability</code> of that
classification. Now, let’s join these predicted classes back to our
original dataset for visualization.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we also keep ID and time for joining, to match observations in the original dataset</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_merge.html" class="external-link">data_join</a></span><span class="op">(</span><span class="va">qol_cancer</span>, <span class="va">out</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"ID"</span>, <span class="st">"Predicted"</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"time"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">Predicted</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-latent-class-trajectories">Visualizing Latent Class Trajectories<a class="anchor" aria-label="anchor" href="#visualizing-latent-class-trajectories"></a>
</h3>
<p>Now we can visualize the average QoL trajectories for each latent
class. This is the most intuitive way to understand the results of a
GMM.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">QoL</span>, color <span class="op">=</span> <span class="va">class</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Average Latent Class Trajectories of Quality of Life"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (1=pre-op, 2=6m, 3=12m)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Quality of Life (QoL)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/theme_modern.html" class="external-link">theme_modern</a></span><span class="op">(</span>show.ticks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/scale_color_material.html" class="external-link">scale_color_material</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/scale_color_material.html" class="external-link">scale_fill_material</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="practical_growthmixture_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The plot clearly reveals two distinct groups:</p>
<ul>
<li>
<strong>Class 1 (blue):</strong> This group starts with a lower
Quality of Life, but shows a steady improvement over the 12-month
period.</li>
<li>
<strong>Class 2 (red):</strong> This group starts with a much higher
Quality of Life and maintains this high level throughout the observation
period.</li>
</ul>
</div>
<div class="section level3">
<h3 id="inspecting-model-parameters">Inspecting Model Parameters<a class="anchor" aria-label="anchor" href="#inspecting-model-parameters"></a>
</h3>
<p>To understand what predicts the outcome within each class, we can
inspect the model parameters using <code><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">model_parameters()</a></code> from
the <code>parameters</code> package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">model_parameters</a></span><span class="op">(</span><span class="va">brms_mixture_2</span>, diagnostic <span class="op">=</span> <span class="cn">NULL</span>, drop <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Class 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter     | Median |          95% CI |     pd</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; (Intercept)   |  48.16 | [ 18.63, 63.83] | 99.70%</span></span>
<span><span class="co">#&gt; hospital1     |   3.82 | [-17.62, 19.56] | 56.20%</span></span>
<span><span class="co">#&gt; educationmid  |   9.32 | [  3.04, 24.36] | 98.65%</span></span>
<span><span class="co">#&gt; educationhigh |  13.04 | [ -3.75, 24.99] | 94.10%</span></span>
<span><span class="co">#&gt; age           |   0.48 | [ -0.83,  1.20] | 84.00%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # Class 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter     | Median |          95% CI |     pd</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; (Intercept)   |  75.51 | [ 63.81, 81.50] |   100%</span></span>
<span><span class="co">#&gt; hospital1     |  -1.29 | [-10.41,  8.28] | 56.70%</span></span>
<span><span class="co">#&gt; educationmid  |   3.98 | [  0.14, 10.17] | 97.65%</span></span>
<span><span class="co">#&gt; educationhigh |  11.53 | [  5.79, 19.47] |   100%</span></span>
<span><span class="co">#&gt; age           |  -0.37 | [ -0.65,  0.29] | 86.25%</span></span></code></pre></div>
<p>The output is neatly separated by class. We can see, for example,
that higher education (<code>educationmid</code>,
<code>educationhigh</code>) is associated with a higher QoL in both
classes, but the magnitude of the effect differs.</p>
</div>
<div class="section level3">
<h3 id="estimated-marginal-means">Estimated Marginal Means<a class="anchor" aria-label="anchor" href="#estimated-marginal-means"></a>
</h3>
<p>We can dive deeper by estimating the marginal means of
<code>QoL</code> for different predictor levels within each class. Let’s
look at the effect of <code>education</code>. The
<code>predict = "link"</code> argument is essential for mixture models,
as it computes the means for each class separately.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_means.html">estimate_means</a></span><span class="op">(</span><span class="va">brms_mixture_2</span>, by <span class="op">=</span> <span class="st">"education"</span>, predict <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated Marginal Means</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; education |          Median (CI) | pd   | Class</span></span>
<span><span class="co">#&gt; -----------------------------------------------</span></span>
<span><span class="co">#&gt; low       | 53.92 (33.41, 63.72) | 100% |     1</span></span>
<span><span class="co">#&gt; low       | 74.43 (67.38, 78.20) | 100% |     2</span></span>
<span><span class="co">#&gt; mid       | 64.11 (49.39, 72.54) | 100% |     1</span></span>
<span><span class="co">#&gt; mid       | 79.19 (73.50, 82.46) | 100% |     2</span></span>
<span><span class="co">#&gt; high      | 63.10 (44.67, 76.24) | 100% |     1</span></span>
<span><span class="co">#&gt; high      | 86.32 (79.66, 93.25) | 100% |     2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors modulated: education</span></span>
<span><span class="co">#&gt; Predictors averaged: time, hospital, age (0.22), ID</span></span>
<span><span class="co">#&gt; Predictions are on the link-scale.</span></span></code></pre></div>
<p>This table gives us the expected mean <code>QoL</code> for each
education level, conditional on class membership. For instance, a
patient with “low” education in Class 2 has an estimated mean QoL of
<code>74.43</code>, whereas a similar patient in Class 1 has an
estimated mean QoL of <code>53.92</code>.</p>
</div>
<div class="section level3">
<h3 id="comparing-levels-with-contrasts">Comparing Levels with Contrasts<a class="anchor" aria-label="anchor" href="#comparing-levels-with-contrasts"></a>
</h3>
<p>We can also compute contrasts between predictor levels to understand
the magnitude of differences.</p>
<p>If we compute contrasts without <code>predict = "link"</code>,
<code><a href="../reference/estimate_contrasts.html">estimate_contrasts()</a></code> averages the effects across both
classes, giving a general sense of inequality.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span></span>
<span>  <span class="va">brms_mixture_2</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"education"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Contrasts Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Level1 | Level2 |         Median (CI) |     pd</span></span>
<span><span class="co">#&gt; ----------------------------------------------</span></span>
<span><span class="co">#&gt; mid    | low    |  7.95 (2.60, 11.32) | 99.65%</span></span>
<span><span class="co">#&gt; high   | low    | 12.69 (7.17, 17.13) |   100%</span></span>
<span><span class="co">#&gt; high   | mid    |  5.67 (1.02,  8.57) | 98.95%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; Predictors averaged: time, hospital, age (0.22), ID</span></span>
<span><span class="co">#&gt; Contrasts are on the response-scale.</span></span></code></pre></div>
<p>More interestingly, we can set <code>predict = "link"</code> to get
contrasts both <em>within</em> and <em>between</em> classes. This
provides a very detailed picture.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span></span>
<span>  <span class="va">brms_mixture_2</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"education"</span>,</span>
<span>  predict <span class="op">=</span> <span class="st">"link"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Contrasts Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Level1 | Level2 |           Median (CI) |     pd</span></span>
<span><span class="co">#&gt; ------------------------------------------------</span></span>
<span><span class="co">#&gt; 1 mid  | 1 low  |  9.32 (  3.04, 24.36) | 98.65%</span></span>
<span><span class="co">#&gt; 1 high | 1 low  | 13.04 ( -3.75, 24.99) | 94.10%</span></span>
<span><span class="co">#&gt; 2 low  | 1 low  | 19.34 (  7.55, 40.32) | 99.95%</span></span>
<span><span class="co">#&gt; 2 mid  | 1 low  | 27.05 ( 15.71, 44.71) |   100%</span></span>
<span><span class="co">#&gt; 2 high | 1 low  | 37.41 ( 23.25, 52.04) |   100%</span></span>
<span><span class="co">#&gt; 1 high | 1 mid  |  0.19 (-14.77,  9.54) | 51.20%</span></span>
<span><span class="co">#&gt; 2 low  | 1 mid  | 10.00 ( -0.73, 24.01) | 96.80%</span></span>
<span><span class="co">#&gt; 2 mid  | 1 mid  | 16.88 (  7.02, 29.15) | 99.45%</span></span>
<span><span class="co">#&gt; 2 high | 1 mid  | 24.44 ( 13.22, 35.72) |   100%</span></span>
<span><span class="co">#&gt; 2 low  | 1 high | 11.78 ( -1.48, 27.71) | 73.90%</span></span>
<span><span class="co">#&gt; 2 mid  | 1 high | 17.61 (  2.51, 32.07) | 99.85%</span></span>
<span><span class="co">#&gt; 2 high | 1 high | 24.59 ( 10.05, 39.85) |   100%</span></span>
<span><span class="co">#&gt; 2 mid  | 2 low  |  3.98 (  0.14, 10.17) | 97.65%</span></span>
<span><span class="co">#&gt; 2 high | 2 low  | 11.53 (  5.79, 19.47) |   100%</span></span>
<span><span class="co">#&gt; 2 high | 2 mid  |  7.55 (  3.15, 11.33) | 99.90%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education</span></span>
<span><span class="co">#&gt; Predictors averaged: time, hospital, age (0.22), ID</span></span>
<span><span class="co">#&gt; Contrasts are on the link-scale.</span></span></code></pre></div>
<p>The output is rich with information. For example,
<code>2 high | 2 low</code> shows the contrast between high and low
education <em>within Class 2</em> (an increase of <code>11.53</code> in
QoL), while <code>2 low | 1 low</code> compares a patient with low
education in Class 2 to a patient with low education in Class 1 (a
difference of <code>19.34</code>).</p>
</div>
<div class="section level3">
<h3 id="quantifying-inequality">Quantifying Inequality<a class="anchor" aria-label="anchor" href="#quantifying-inequality"></a>
</h3>
<p>Finally, <code><a href="../reference/estimate_contrasts.html">estimate_contrasts()</a></code> has a powerful
<code>comparison = "inequality"</code> argument. This calculates the
average absolute difference between all levels of a predictor, providing
a single number that quantifies the overall disparity associated with
that variable. Let’s compare the inequality associated with
<code>education</code> versus <code>hospital</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span></span>
<span>  <span class="va">brms_mixture_2</span>,</span>
<span>  contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"education"</span>, <span class="st">"hospital"</span><span class="op">)</span>,</span>
<span>  comparison <span class="op">=</span> <span class="st">"inequality"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Inequality Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter |        Median (CI) |   pd</span></span>
<span><span class="co">#&gt; -------------------------------------</span></span>
<span><span class="co">#&gt; education | 8.46 (4.85, 11.42) | 100%</span></span>
<span><span class="co">#&gt; hospital  | 1.40 (0.11,  8.87) | 100%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: QoL</span></span>
<span><span class="co">#&gt; Predictors contrasted: education, hospital</span></span>
<span><span class="co">#&gt; Differences are on the response-scale.</span></span></code></pre></div>
<p>The results are striking. The inequality median for
<code>education</code> is <code>8.46</code>, while for
<code>hospital</code> it is only <code>1.40</code>. This suggests that a
patient’s education level is associated with far greater disparities in
their quality of life trajectory than the hospital where they received
treatment.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Growth Mixture Models are an excellent tool for uncovering hidden
heterogeneity in longitudinal data. By using <code>brms</code> to fit
these complex models and the <code>easystats</code> ecosystem to process
and interpret them, researchers can move from complex output to
actionable insights with ease. This vignette has shown how to identify
latent classes, visualize their trajectories, and quantify the effects
of covariates in a straightforward and intuitive workflow.</p>
</div>
<div class="section level2">
<h2 id="supplement">Supplement<a class="anchor" aria-label="anchor" href="#supplement"></a>
</h2>
<p>The estimation of latent class membership in finite mixture models
within the R package <code>brms</code> is not governed by a single,
fixed mechanism. Instead, <code>brms</code> provides a flexible and
powerful framework that allows the researcher to explicitly define the
data-generating process, including the factors that determine class
membership. The central question of whether class membership is
determined by the outcome’s trajectory, by predictors, or if predictors
are only relevant after classification, can be addressed directly: all
of these scenarios represent valid modeling choices that can be
implemented within <code>brms</code>. In a mixture model, the
probabilities of belonging to each latent class - the mixing
proportions, denoted as <span class="math inline">\theta</span> - are
themselves parameters of the model. Consequently, they can be modeled as
a function of predictors.</p>
<p>Here’s a summary of how to specify these different scenarios in
<code>brms</code>:</p>
<table class="table">
<caption>Example <code>brms</code> Formula Syntax for Common Mixture
Model Scenarios</caption>
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="left">Scenario</th>
<th align="left">Research Question</th>
<th align="left">Example <code>brms</code> Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Simple Mixture</strong></td>
<td align="left">“Are there two or more distinct latent groups in my
outcome data, ignoring all predictors?”</td>
<td align="left"><code>bf(y ~ 1, family = mixture(gaussian, nmix = 2))</code></td>
</tr>
<tr class="even">
<td align="left"><strong>Predicting Component Means</strong></td>
<td align="left">“Does a treatment (<code>x</code>) affect the outcome
differently for the two latent groups?”</td>
<td align="left">
<code>bf(y ~ 1, mu1 ~ x, mu2 ~ x, family = mix)</code>
or simply <code>bf(y ~ x, family = mix)</code>
</td>
</tr>
<tr class="odd">
<td align="left"><strong>Predicting Mixing Proportion</strong></td>
<td align="left">“Does a demographic variable (<code>z</code>) predict
which latent group an individual is likely to belong to?”</td>
<td align="left"><code>bf(y ~ 1, theta2 ~ z, family = mix)</code></td>
</tr>
<tr class="even">
<td align="left"><strong>Full Distributional Model</strong></td>
<td align="left">“How do treatment (<code>x</code>) and demographics
(<code>z</code>) jointly influence both the outcome within each group
and the probability of group membership?”</td>
<td align="left"><code>bf(y ~ 1, mu1 ~ x, mu2 ~ x, theta2 ~ z, sigma ~ group, family = mix)</code></td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="example-codes">Example Codes<a class="anchor" aria-label="anchor" href="#example-codes"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this model is actually equivalent to the one we used in the vignette</span></span>
<span><span class="co"># but it allows for different predictors for each class</span></span>
<span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>    <span class="co"># formula for individual trajectories</span></span>
<span>    <span class="va">QoL</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>    <span class="co"># predictors for class 1</span></span>
<span>    <span class="va">mu1</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">hospital</span> <span class="op">+</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>    <span class="co"># predictors for class 2</span></span>
<span>    <span class="va">mu2</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">hospital</span> <span class="op">+</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/mixture.html" class="external-link">mixture</a></span><span class="op">(</span><span class="va">gaussian</span>, nmix <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">qol_cancer</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,      <span class="co"># Number of MCMC chains</span></span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>,     <span class="co"># Total iterations per chain</span></span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,       <span class="co"># Use 4 CPU cores</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,     <span class="co"># For reproducibility</span></span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># in this example, we also model the class membership probabilities</span></span>
<span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>    <span class="co"># formula for individual trajectories</span></span>
<span>    <span class="va">QoL</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>    <span class="co"># predictors for class 1</span></span>
<span>    <span class="va">mu1</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">hospital</span> <span class="op">+</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>    <span class="co"># predictors for class 2</span></span>
<span>    <span class="va">mu2</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">hospital</span> <span class="op">+</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">time</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>    <span class="co"># predictors for class membership probabilities</span></span>
<span>    <span class="va">theta1</span> <span class="op">~</span> <span class="va">hospital</span> <span class="op">+</span> <span class="va">education</span>,</span>
<span>    <span class="va">theta2</span> <span class="op">~</span> <span class="va">hospital</span> <span class="op">+</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span>,</span>
<span>    family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/mixture.html" class="external-link">mixture</a></span><span class="op">(</span><span class="va">gaussian</span>, nmix <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">qol_cancer</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,      <span class="co"># Number of MCMC chains</span></span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>,     <span class="co"># Total iterations per chain</span></span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,       <span class="co"># Use 4 CPU cores</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,     <span class="co"># For reproducibility</span></span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="https://remi-theriault.com/" class="external-link">Rémi Thériault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
