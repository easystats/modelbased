<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data grids • modelbased</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data grids">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.2.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-introductions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Introductions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-introductions">
<li><a class="dropdown-item" href="../articles/overview_of_vignettes.html">Overview of Vignettes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_models.html">Mixed effects models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpretation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_response.html">Use a model to make predictions</a></li>
    <li><a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualization</h6></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_relation.html">Visualize effects and interactions</a></li>
    <li><a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies">
<li><h6 class="dropdown-header" data-toc-skip>Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/workflow_modelbased.html">Understanding your models</a></li>
    <li><a class="dropdown-item" href="../articles/practical_causality.html">Causal inference for observational data</a></li>
    <li><a class="dropdown-item" href="../articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a></li>
    <li><a class="dropdown-item" href="../articles/practical_its.html">Interrupted Time Series Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Contrasts</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_1.html">Contrasts and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_2.html">User Defined Contrasts and Joint Tests</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_3.html">Slopes, floodlight and spotlight analysis (Johnson-Neyman intervals)</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_4.html">Contrasts and comparisons for generalized linear models</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_5.html">Contrasts and comparisons for zero-inflation models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats">
<li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data grids</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/main/vignettes/visualisation_matrix.Rmd" class="external-link"><code>vignettes/visualisation_matrix.Rmd</code></a></small>
      <div class="d-none name"><code>visualisation_matrix.Rmd</code></div>
    </div>

    
    
<p>Sometimes, for instance for <strong>visualization</strong> purposes,
we want to extract a <strong>reference grid</strong> (or <em>data
grid</em>) of our dataset, that we will call a <strong>visualisation
matrix</strong>. This reference grid usually contains the same variables
than the original dataset, but reorganized in a particular,
<strong>balanced</strong>, way. For instance, it might contain all the
combinations of factors, or equally spread points of a continuous
variable. These reference grids are often used as data for predictions
of statistical models, to help us represent and understand them.</p>
<div class="section level2">
<h2 id="simple-linear-regression">Simple linear regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"></a>
</h2>
<p>For instance, let’s fit a simple linear model that models the
relationship between <code>Sepal.Width</code> and
<code>Sepal.Length</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/easystats/" class="external-link">easystats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Sepal.Length</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Parameter    | Coefficient |   SE |        95% CI | t(148) |      p
&gt; -------------------------------------------------------------------
&gt; (Intercept)  |        3.42 | 0.25 | [ 2.92, 3.92] |  13.48 | &lt; .001
&gt; Sepal Length |       -0.06 | 0.04 | [-0.15, 0.02] |  -1.44 | 0.152</code></pre>
<p>The most obvious way of representing this model is to plot the data
points and add the regression line using the <code>geom_smooth</code>
function from <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualisation_matrix_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>But how to “access” the data of this regression line? One good option
is to select some values of of the predictor
(<code>Sepal.Length</code>), and <strong>predict</strong> (using the
base R <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method for now) the response
(<code>Sepal.Width</code>) using the model. Using these <em>x</em> and
<em>y</em> points, we can then create the regression line.</p>
<p>Let’s try the <a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link"><code>get_datagrid()</code></a>
function from the <strong>insight</strong> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="st">"Sepal.Length"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Visualisation Grid
&gt; 
&gt; Sepal.Length
&gt; ------------
&gt; 4.30        
&gt; 4.70        
&gt; 5.10        
&gt; 5.50        
&gt; 5.90        
&gt; 6.30        
&gt; 6.70        
&gt; 7.10        
&gt; 7.50        
&gt; 7.90</code></pre>
<p>If we pass a numeric column to the function, it will return a vector
of <strong>equally spread points</strong> (having the same range, i.e.,
the same minimum and maximum, than the original data). The default
<strong>length</strong> is 10, but we can adjust that through the
<code>length</code> argument. For instance, for linear relationships
(i.e., a straight line), two points are in theory sufficient. Let’s
generate predictions using this reference grid of the predictor.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vizdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="st">"Sepal.Length"</span><span class="op">]</span>, length <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">vizdata</span><span class="op">$</span><span class="va">Predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">vizdata</span><span class="op">)</span></span>
<span><span class="va">vizdata</span></span></code></pre></div>
<pre><code>&gt; Visualisation Grid
&gt; 
&gt; Sepal.Length | Predicted
&gt; ------------------------
&gt; 4.30         |      3.15
&gt; 7.90         |      2.93</code></pre>
<p>Now that we have our <em>x</em> and <em>y</em> values, we can plot
the line as an overlay to the actual data points:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vizdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualisation_matrix_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>As we can see, it is quite similar to the previous plot. So, when can
this be useful?</p>
</div>
<div class="section level2">
<h2 id="mixed-models">Mixed models<a class="anchor" aria-label="anchor" href="#mixed-models"></a>
</h2>
<p>Data grids are useful to represent more complex models. For instance,
in the models above, the <strong>negative</strong> relationship between
the length and width of the sepals is in fact biased by the presence of
three different species. One way of adjusting the model for this
grouping structure is to add it as a <strong>random effect</strong> in a
<strong>mixed model</strong>. In the model below, the “fixed” effects
(the parameters of interest) will be adjusted (“averaged over”) to the
random effects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; # Fixed Effects
&gt; 
&gt; Parameter    | Coefficient |   SE |       95% CI | t(146) |      p
&gt; ------------------------------------------------------------------
&gt; (Intercept)  |        1.04 | 0.43 | [0.20, 1.89] |   2.45 | 0.015 
&gt; Sepal Length |        0.34 | 0.05 | [0.25, 0.44] |   7.47 | &lt; .001
&gt; 
&gt; # Random Effects
&gt; 
&gt; Parameter               | Coefficient
&gt; -------------------------------------
&gt; SD (Intercept: Species) |        0.57
&gt; SD (Residual)           |        0.29</code></pre>
<p>As we can see, when adjusting for the species, the relationship
between the two variables <strong>has become positive</strong>!</p>
<p>We can represent it using the same procedure as above, but note that
instead of using the base R <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function, we will be
using <a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link"><em>get_predicted()</em></a>,
from the <strong>insight</strong> package, which is a more robust and
user-friendly version of <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vizdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="st">"Sepal.Length"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">vizdata</span><span class="op">$</span><span class="va">Predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">get_predicted</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">vizdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vizdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualisation_matrix_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="fixed-variables">Fixed variables<a class="anchor" aria-label="anchor" href="#fixed-variables"></a>
</h2>
<p>The above way of constructing the reference grid, i.e., by providing
a single column of data to the function, is almost equivalent to the
following:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vizdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">iris</span>, by <span class="op">=</span> <span class="st">"Sepal.Length"</span><span class="op">)</span></span>
<span><span class="va">vizdata</span></span></code></pre></div>
<pre><code>&gt; Visualisation Grid
&gt; 
&gt; Sepal.Length | Sepal.Width | Petal.Length | Petal.Width | Species
&gt; -----------------------------------------------------------------
&gt; 4.30         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 4.70         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 5.10         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 5.50         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 5.90         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 6.30         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 6.70         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 7.10         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 7.50         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 7.90         |        3.06 |         3.76 |        1.20 | setosa 
&gt; 
&gt; Maintained constant: Sepal.Width, Petal.Length, Petal.Width, Species</code></pre>
<p>However, the other variables (present in the dataframe but not
selected as <code>at</code>) are “fixed”, <em>i.e.</em>, they are
maintained at specific values. This is useful when we have other
variables in the model in whose effect we are not interested.</p>
<p>By default, <strong>factors</strong> are fixed by their
<strong>“reference” level</strong> and <strong>numeric
variables</strong> are fixed at their <strong>mean</strong>. However,
this can be easily changed:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vizdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">iris</span>, by <span class="op">=</span> <span class="st">"Sepal.Length"</span>, numerics <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span><span class="va">vizdata</span></span></code></pre></div>
<pre><code>&gt; Visualisation Grid
&gt; 
&gt; Sepal.Length | Sepal.Width | Petal.Length | Petal.Width | Species
&gt; -----------------------------------------------------------------
&gt; 4.30         |           2 |            1 |        0.10 | setosa 
&gt; 4.70         |           2 |            1 |        0.10 | setosa 
&gt; 5.10         |           2 |            1 |        0.10 | setosa 
&gt; 5.50         |           2 |            1 |        0.10 | setosa 
&gt; 5.90         |           2 |            1 |        0.10 | setosa 
&gt; 6.30         |           2 |            1 |        0.10 | setosa 
&gt; 6.70         |           2 |            1 |        0.10 | setosa 
&gt; 7.10         |           2 |            1 |        0.10 | setosa 
&gt; 7.50         |           2 |            1 |        0.10 | setosa 
&gt; 7.90         |           2 |            1 |        0.10 | setosa 
&gt; 
&gt; Maintained constant: Sepal.Width, Petal.Length, Petal.Width, Species</code></pre>
</div>
<div class="section level2">
<h2 id="target-variables">Target variables<a class="anchor" aria-label="anchor" href="#target-variables"></a>
</h2>
<p>If more than one target variable is selected,
<code><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid()</a></code> will return the <strong>combination</strong>
of them (<em>i.e.</em>, all unique values crossed together). This can be
useful in the case of an <strong>interaction</strong> between a numeric
variable and a factor.</p>
<p>Let’s visualise the regression line for each of the levels of
<code>Species</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Sepal.Length</span> <span class="op">*</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vizdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">iris</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Species"</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">vizdata</span><span class="op">$</span><span class="va">Predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">get_predicted</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">vizdata</span><span class="op">)</span></span>
<span><span class="va">vizdata</span></span></code></pre></div>
<pre><code>&gt; Visualisation Grid
&gt; 
&gt; Sepal.Length | Species    | Sepal.Width | Petal.Length | Petal.Width | Predicted
&gt; --------------------------------------------------------------------------------
&gt; 4.30         | setosa     |        3.06 |         3.76 |        1.20 |      2.86
&gt; 5.20         | setosa     |        3.06 |         3.76 |        1.20 |      3.58
&gt; 6.10         | setosa     |        3.06 |         3.76 |        1.20 |      4.30
&gt; 7.00         | setosa     |        3.06 |         3.76 |        1.20 |      5.02
&gt; 7.90         | setosa     |        3.06 |         3.76 |        1.20 |      5.74
&gt; 4.30         | versicolor |        3.06 |         3.76 |        1.20 |      2.25
&gt; 5.20         | versicolor |        3.06 |         3.76 |        1.20 |      2.53
&gt; 6.10         | versicolor |        3.06 |         3.76 |        1.20 |      2.82
&gt; 7.00         | versicolor |        3.06 |         3.76 |        1.20 |      3.11
&gt; 7.90         | versicolor |        3.06 |         3.76 |        1.20 |      3.40
&gt; 4.30         | virginica  |        3.06 |         3.76 |        1.20 |      2.44
&gt; 5.20         | virginica  |        3.06 |         3.76 |        1.20 |      2.65
&gt; 6.10         | virginica  |        3.06 |         3.76 |        1.20 |      2.86
&gt; 7.00         | virginica  |        3.06 |         3.76 |        1.20 |      3.07
&gt; 7.90         | virginica  |        3.06 |         3.76 |        1.20 |      3.28
&gt; 
&gt; Maintained constant: Sepal.Width, Petal.Length, Petal.Width</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vizdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualisation_matrix_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="preserve-range">Preserve range<a class="anchor" aria-label="anchor" href="#preserve-range"></a>
</h2>
<p>However, it is generally not a good practice to extend the regression
lines beyond the range of its original data, as it is the case here for
the <strong>red line</strong>. The <code>preserve_range</code> option
allows to remove observations that are “outside” the original dataset
(however, the length should be increased to improve the precision toward
the edges):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vizdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">iris</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Species"</span><span class="op">)</span>,</span>
<span>  length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  preserve_range <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vizdata</span><span class="op">$</span><span class="va">Predicted_Sepal.Width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">get_predicted</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">vizdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vizdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Predicted_Sepal.Width</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualisation_matrix_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="visualising-an-interaction-between-two-numeric-variables-three-way-interaction">Visualising an interaction between two numeric variables (three-way
interaction)<a class="anchor" aria-label="anchor" href="#visualising-an-interaction-between-two-numeric-variables-three-way-interaction"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">*</span> <span class="va">Petal.Width</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Parameter                  | Coefficient |   SE |         95% CI | t(146) |      p
&gt; ----------------------------------------------------------------------------------
&gt; (Intercept)                |        4.58 | 0.11 | [ 4.36,  4.80] |  40.89 | &lt; .001
&gt; Petal Length               |        0.44 | 0.07 | [ 0.31,  0.57] |   6.74 | &lt; .001
&gt; Petal Width                |       -1.24 | 0.22 | [-1.67, -0.81] |  -5.65 | &lt; .001
&gt; Petal Length × Petal Width |        0.19 | 0.03 | [ 0.12,  0.25] |   5.62 | &lt; .001</code></pre>
<p>This idea can also be used to visualise interactions between two
numeric variables, <strong>aka the nightmare of every
scientist</strong>. One possibility is to basically represent the
relationship between the response and one predictor <strong>at a few
representative values of the second predictor</strong>.</p>
<p>In this case, we will represent the regression line between
<code>Sepal.Length</code> and <code>Petal.Length</code> and a 5 equally
spaced values of <code>Petal.Length</code>, to get a feel for the
interaction.</p>
<p>We can obtain the right reference grid quite easily by chaining two
data grids together as follows:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vizdata</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="st">"Petal.Width"</span>, length <span class="op">=</span> <span class="fl">5</span>, numerics <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p>What did we do here? We started by generating a reference grid
containing all the combinations between the 10 equally spread values of
the two target variables, creating <code>10 * 10 = 100</code> rows. The
next step was to reduce <code>Petal.Length</code> to a set of 5 values,
but without touching the other variables (<em>i.e.</em>, keeping the 10
values created for <code>Petal.Length</code>). This was achieved using
<code>numerics = "all"</code>.</p>
<p>We can then visualise it as follows:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vizdata</span><span class="op">$</span><span class="va">Predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/get_predicted.html" class="external-link">get_predicted</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">vizdata</span><span class="op">)</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, color <span class="op">=</span> <span class="va">Petal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vizdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Predicted</span>, group <span class="op">=</span> <span class="va">Petal.Width</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualisation_matrix_files/figure-html/unnamed-chunk-15-1.png" width="100%"></p>
<p>Such plot can be more clear by expressing the interaction variable in
terms of deviations from the mean (as a standardized variable).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Express values in an abstract way</span></span>
<span><span class="va">vizdata</span><span class="op">$</span><span class="va">Petal.Width</span> <span class="op">&lt;-</span> <span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/format_standardize.html" class="external-link">format_standardize</a></span><span class="op">(</span></span>
<span>  <span class="va">vizdata</span><span class="op">$</span><span class="va">Petal.Width</span>,</span>
<span>  reference <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Only shapes from 21 to 25 have a fill aesthetic</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/geom_point2.html" class="external-link">geom_point2</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Petal.Width</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"white"</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vizdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Predicted</span>, color <span class="op">=</span> <span class="va">Petal.Width</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualisation_matrix_files/figure-html/unnamed-chunk-16-1.png" width="100%"></p>
<p>As the <code>Petal.Width</code> increases (becomes yellow), the
coefficient between <code>Petal.Length</code> and
<code>Sepal.Length</code> increases (the slope is more steep). Although,
as we can guess, this in fact captures the underlying effect of species…
<strong>but we’ll leave discussing the meaningfulness of your models to
you :)</strong></p>
</div>
<div class="section level2">
<h2 id="get_datagrid-also-runs-directly-on-model-objects">
<code>get_datagrid()</code> also runs directly on model objects<a class="anchor" aria-label="anchor" href="#get_datagrid-also-runs-directly-on-model-objects"></a>
</h2>
<p>To illustrate this, let’s set up a <strong>general additive mixed
model (GAMM)</strong>, where we are going to specify a <strong>smooth
term</strong> (a non-linear relationship; specified by <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s()</a></code>
function) and some <strong>random effects</strong> structure.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gamm4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">gamm4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gamm4/man/gamm4.html" class="external-link">gamm4</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Petal.Length</span> <span class="op">~</span> <span class="va">Petal.Width</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">iris</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>One can directly extract the visualization matrix for this model by
entering the entire object into the function:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">model</span>, length <span class="op">=</span> <span class="fl">3</span>, include_random <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Visualisation Grid
&gt; 
&gt; Petal.Width | Sepal.Length
&gt; --------------------------
&gt; 0.10        |         4.30
&gt; 1.30        |         4.30
&gt; 2.50        |         4.30
&gt; 0.10        |         6.10
&gt; 1.30        |         6.10
&gt; 2.50        |         6.10
&gt; 0.10        |         7.90
&gt; 1.30        |         7.90
&gt; 2.50        |         7.90</code></pre>
<p>We also skip the smooth term if we are interested only in the fixed
effects:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">model</span>, length <span class="op">=</span> <span class="fl">3</span>, include_random <span class="op">=</span> <span class="cn">FALSE</span>, include_smooth <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Visualisation Grid
&gt; 
&gt; Petal.Width
&gt; -----------
&gt; 0.10       
&gt; 1.30       
&gt; 2.50       
&gt; 
&gt; Maintained constant: Sepal.Length</code></pre>
<p>We can also include random effects:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span><span class="va">model</span>, length <span class="op">=</span> <span class="fl">5</span>, include_random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Visualisation Grid
&gt; 
&gt; Petal.Width | Sepal.Length | Species   
&gt; ---------------------------------------
&gt; 0.10        |         4.30 | setosa    
&gt; 0.10        |         5.20 | setosa    
&gt; 1.30        |         5.20 | versicolor
&gt; 1.30        |         6.10 | versicolor
&gt; 1.30        |         7.00 | versicolor
&gt; 1.90        |         5.20 | virginica 
&gt; 2.50        |         5.20 | virginica 
&gt; 1.90        |         6.10 | virginica 
&gt; 2.50        |         6.10 | virginica 
&gt; 1.90        |         7.00 | virginica 
&gt; 2.50        |         7.00 | virginica 
&gt; 1.90        |         7.90 | virginica 
&gt; 2.50        |         7.90 | virginica</code></pre>
</div>
<div class="section level2">
<h2 id="controlled-standardized-change">Controlled standardized change<a class="anchor" aria-label="anchor" href="#controlled-standardized-change"></a>
</h2>
<p>Although the plot above is nice, and all, we would like the
standardized changes in SD to be smoother (e.g., by increments of 1 SD).
This can be achieved by first requesting the values that we want, and
then <strong>unstandardizing</strong> it.</p>
<p>Let’s use the same model as above, and then obtain a data grid with
specific values for <code>Petal.Width</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vizdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">*</span> <span class="va">Petal.Width</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/get_datagrid.html" class="external-link">get_datagrid</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width = seq(-3, 3)"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/datawizard/reference/standardize.html" class="external-link">unstandardize</a></span><span class="op">(</span><span class="va">vizdata</span>, select <span class="op">=</span> <span class="st">"Petal.Width"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate_expectation.html">estimate_relation</a></span><span class="op">(</span><span class="va">vizdata</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vizdata</span><span class="op">$</span><span class="va">Petal.Width</span> <span class="op">&lt;-</span> <span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/format_standardize.html" class="external-link">format_standardize</a></span><span class="op">(</span><span class="va">vizdata</span><span class="op">$</span><span class="va">Petal.Width</span>, reference <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 6. Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/geom_point2.html" class="external-link">geom_point2</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Petal.Width</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vizdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Predicted</span>, color <span class="op">=</span> <span class="va">Petal.Width</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualisation_matrix_files/figure-html/unnamed-chunk-21-1.png" width="100%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="https://remi-theriault.com/" class="external-link">Rémi Thériault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
