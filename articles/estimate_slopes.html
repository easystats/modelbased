<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimate marginal effects • modelbased</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate marginal effects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.13.0.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-introductions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Introductions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-introductions">
<li><a class="dropdown-item" href="../articles/overview_of_vignettes.html">Overview of Vignettes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_models.html">Mixed effects models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpretation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_response.html">Use a model to make predictions</a></li>
    <li><a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualization</h6></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_tinyplot.html">Plotting estimated marginal means with tinyplot</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_relation.html">Visualize effects and interactions</a></li>
    <li><a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies">
<li><h6 class="dropdown-header" data-toc-skip>Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/workflow_modelbased.html">Understanding your models</a></li>
    <li><a class="dropdown-item" href="../articles/practical_causality.html">Causal inference for observational data</a></li>
    <li><a class="dropdown-item" href="../articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a></li>
    <li><a class="dropdown-item" href="../articles/practical_inequalities.html">Measuring and comparing absolute and relative inequalities</a></li>
    <li><a class="dropdown-item" href="../articles/practical_its.html">Interrupted Time Series Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/practical_growthmixture.html">An Introduction to Growth Mixture Models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Contrasts</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_1.html">Contrasts and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_2.html">User Defined Contrasts and Joint Tests</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_3.html">Slopes, floodlight and spotlight analysis (Johnson-Neyman intervals)</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_4.html">Contrasts and comparisons for generalized linear models</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_5.html">Contrasts and comparisons for zero-inflation models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats">
<li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate marginal effects</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/main/vignettes/estimate_slopes.Rmd" class="external-link"><code>vignettes/estimate_slopes.Rmd</code></a></small>
      <div class="d-none name"><code>estimate_slopes.Rmd</code></div>
    </div>

    
    
<p>This vignette will present how to estimate marginal effects and
derivatives using <code><a href="../reference/estimate_slopes.html">estimate_slopes()</a></code>.</p>
<p><strong>Marginal means <em>vs.</em> Marginal effects</strong>.
Marginal slopes are to numeric predictors what marginal means are to
categorical predictors, in the sense that they can eventually be
“averaged over” other predictors of the model. The key difference is
that, while marginal means return averages of the outcome variable,
which allows you to say for instance “the average reaction time in the
C1 condition is 1366 ms”, marginal effects return <strong>averages of
coefficients</strong>. This allows you to say, for instance, “the
average <em>effect of x</em> in the C1 condition is 0.33”. When you
visualize marginal effects, the y-axis is the effect/slope/beta of a
given numeric predictor.</p>
<p>Let’s see some examples.</p>
<div class="section level2">
<h2 id="marginal-effects-over-a-factors-levels">Marginal effects over a factor’s levels<a class="anchor" aria-label="anchor" href="#marginal-effects-over-a-factors-levels"></a>
</h2>
<p>Let’s fit a linear model with a factor interacting with a continuous
predictor and visualize it.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/" class="external-link">parameters</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/">modelbased</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">*</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/estimate_expectation.html">estimate_relation</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_slopes_files/figure-html/unnamed-chunk-2-1.png" width="2187.5"></p>
<p>It seems like the slope of the effect is roughly similar (in the same
direction) across the different factor levels.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Parameter                           | Coefficient |   SE |         95% CI
&gt; -------------------------------------------------------------------------
&gt; (Intercept)                         |        4.21 | 0.41 | [ 3.41,  5.02]
&gt; Petal Length                        |        0.54 | 0.28 | [ 0.00,  1.09]
&gt; Species [versicolor]                |       -1.81 | 0.60 | [-2.99, -0.62]
&gt; Species [virginica]                 |       -3.15 | 0.63 | [-4.41, -1.90]
&gt; Petal Length × Species [versicolor] |        0.29 | 0.30 | [-0.30,  0.87]
&gt; Petal Length × Species [virginica]  |        0.45 | 0.29 | [-0.12,  1.03]
&gt; 
&gt; Parameter                           | t(144) |      p
&gt; -----------------------------------------------------
&gt; (Intercept)                         |  10.34 | &lt; .001
&gt; Petal Length                        |   1.96 | 0.052 
&gt; Species [versicolor]                |  -3.02 | 0.003 
&gt; Species [virginica]                 |  -4.97 | &lt; .001
&gt; Petal Length × Species [versicolor] |   0.97 | 0.334 
&gt; Petal Length × Species [virginica]  |   1.56 | 0.120</code></pre>
<p>Moreover, the interaction is not significant. However, we see below
that removing the interaction does not <em>substantially</em> improve
the model’s performance. So, for the sake of the demonstration, let’s
say we want to keep the maximal effect structure.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html" class="external-link">test_performance</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">model2</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Name   | Model |    BF | df | df_diff | Chi2 |     p
&gt; ----------------------------------------------------
&gt; model  |    lm |       |  7 |         |      |      
&gt; model2 |    lm | 26.52 |  5 |      -2 | 3.47 | 0.177
&gt; Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</code></pre>
<p>Although we are satisfied with our model and its performance, imagine
we are not interested in the effect of <code>Petal.Length</code> for
different Species, but rather, in its <strong>general trend</strong>
“across” all different species. We need to compute the <strong>marginal
effect</strong> of the predictor, which corresponds to its slope
<em>averaged</em> (it’s a bit more complex than a simple averaging but
that’s the idea) over the different factor levels.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slopes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model</span>, trend <span class="op">=</span> <span class="st">"Petal.Length"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slopes</span></span></code></pre></div>
<pre><code>&gt; Estimated Marginal Effects
&gt; 
&gt; Slope |   SE |       95% CI | t(144) |      p
&gt; ---------------------------------------------
&gt; 0.79  | 0.10 | [0.59, 0.99] |   7.69 | &lt; .001
&gt; 
&gt; Marginal effects estimated for Petal.Length
&gt; Type of slope was dY/dX</code></pre>
<p>We can see that the effect of <code>Petal.Length</code>,
<strong>marginalized over Species</strong>, is positive and
significant.</p>
</div>
<div class="section level2">
<h2 id="effects-for-each-factors-levels">Effects for each factor’s levels<a class="anchor" aria-label="anchor" href="#effects-for-each-factors-levels"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slopes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model</span>, trend <span class="op">=</span> <span class="st">"Petal.Length"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slopes</span></span></code></pre></div>
<pre><code>&gt; Estimated Marginal Effects
&gt; 
&gt; Species    | Slope |   SE |        95% CI | t(144) |      p
&gt; -----------------------------------------------------------
&gt; setosa     |  0.54 | 0.28 | [ 0.00, 1.09] |   1.96 |  0.052
&gt; versicolor |  0.83 | 0.10 | [ 0.63, 1.03] |   8.10 | &lt; .001
&gt; virginica  |  1.00 | 0.09 | [ 0.82, 1.17] |  11.43 | &lt; .001
&gt; 
&gt; Marginal effects estimated for Petal.Length
&gt; Type of slope was dY/dX</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">slopes</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_slopes_files/figure-html/unnamed-chunk-6-1.png" width="2187.5"></p>
</div>
<div class="section level2">
<h2 id="interactions-between-two-continuous-variables">Interactions between two continuous variables<a class="anchor" aria-label="anchor" href="#interactions-between-two-continuous-variables"></a>
</h2>
<p>Interactions between two continuous variables are often not
straightforward to visualize and interpret. Thanks to the model-based
approach, one can represent the effect of one of the variables as a
function of the other variable.</p>
<p>Such plot, also referred to as <strong>Johnson-Neyman
intervals</strong>, shows how the effect (the “slope”) of one variable
varies depending on another variable. It is useful in the case of
complex interactions between continuous variables. See also <a href="https://easystats.github.io/modelbased/articles/introduction_comparisons_3.html">this
vignette</a> for further details.</p>
<p>For instance, the plot below shows that the effect of <code>hp</code>
(the y-axis) is significantly negative only when <code>wt</code> is low
(<code>&lt; ~4</code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span> <span class="op">*</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slopes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model</span>, trend <span class="op">=</span> <span class="st">"hp"</span>, by <span class="op">=</span> <span class="st">"wt"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">slopes</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_slopes_files/figure-html/unnamed-chunk-7-1.png" width="2187.5"></p>
</div>
<div class="section level2">
<h2 id="describing-and-reporting-non-linear-relationships-e-g--in-gams">Describing and reporting non-linear relationships (e.g., in
GAMs)<a class="anchor" aria-label="anchor" href="#describing-and-reporting-non-linear-relationships-e-g--in-gams"></a>
</h2>
<p><strong>Complex problems require modern solutions.</strong></p>
<p>General Additive Models (GAMs) are a powerful class of models that
extend the capabilities of traditional GLMs. In particular, they are
able to parsimoniously model possibly non-linear relationship.</p>
<p>Let’s take for instance the following model:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a non-linear General Additive Model (GAM)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">Petal.Length</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/estimate_expectation.html">estimate_relation</a></span><span class="op">(</span><span class="va">model</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_slopes_files/figure-html/unnamed-chunk-8-1.png" width="2187.5"></p>
<p>The GAMs nicely models the complex relationship between the two
variables (if we don’t take into account the different species of
course).</p>
<p>But how to interpret and report in a manuscript such results? We
can’t simply paste the figure right? Right? Reviewers will want some
statistics, some numbers between brackets, otherwise it doesn’t look
serious does it.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; # Fixed Effects
&gt; 
&gt; Parameter   | Coefficient |   SE |       95% CI | t(142.33) |      p
&gt; --------------------------------------------------------------------
&gt; (Intercept) |        3.06 | 0.03 | [3.01, 3.11] |    118.31 | &lt; .001
&gt; 
&gt; # Smooth Terms
&gt; 
&gt; Parameter                  |     F |   df |      p
&gt; --------------------------------------------------
&gt; Smooth term (Petal Length) | 17.52 | 6.67 | &lt; .001</code></pre>
<p>The problem with GAMs is that their parameters (i.e., the
coefficients), are not easily interpretable. Here we can see one line
corresponding to the smooth term. It’s significant, great, but what does
it mean? And if we run the GAM using other packages (e.g.,
<a href="https://mc-stan.org/rstanarm/" class="external-link">rstanarm</a> or <a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a>), the parameters will not
be the same. What to do!</p>
<p>Because the meaning of these parameters is somewhat disconnected with
our need for relationship understanding, another possibility is to
compute the <strong>marginal linear effect</strong> of the smooth term,
i.e., the “derivative”, using <code>estimate_slopes</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute derivative</span></span>
<span><span class="va">deriv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>  trend <span class="op">=</span> <span class="st">"Petal.Length"</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"Petal.Length"</span>,</span>
<span>  length <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualise</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_slopes_files/figure-html/unnamed-chunk-10-1.png" width="2187.5"></p>
<p>This plot represents the “slope” of the curve at each point of the
curve. As you can see, there is a significant negative trend (after
Petal.Length = 2), followed by a significant positive trend (around
Petal.Length = 4). <strong>Marginal derivatives</strong> allow us to
make inferences at each point of the relationship!</p>
<p>Finally, to help reporting that in a manuscript, we can divide this
into chunks and obtain a summary for the trend of each chunk, including
the direction of the effects and whether it is statistically significant
or not.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Johnson-Neymann Intervals
&gt; 
&gt; Start |  End | Direction | Confidence     
&gt; ------------------------------------------
&gt; 1.00  | 1.72 | positive  | Not Significant
&gt; 1.77  | 1.95 | negative  | Not Significant
&gt; 2.01  | 3.15 | negative  | Significant    
&gt; 3.21  | 3.44 | negative  | Not Significant
&gt; 3.50  | 3.68 | positive  | Not Significant
&gt; 3.74  | 4.28 | positive  | Significant    
&gt; 4.34  | 6.24 | positive  | Not Significant
&gt; 6.30  | 6.90 | negative  | Not Significant
&gt; 
&gt; Marginal effects estimated for Petal.Length
&gt; Type of slope was dY/dX</code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Johnson, P.O. &amp; Fay, L.C. (1950). The Johnson-Neyman technique,
its theory and application. Psychometrika, 15, 349-367. doi:
10.1007/BF02288864</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="https://remi-theriault.com/" class="external-link">Rémi Thériault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
