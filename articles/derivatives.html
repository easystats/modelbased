<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="modelbased">
<title>Interpret simple and complex models using the power of Effect Derivatives ‚Ä¢ modelbased</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interpret simple and complex models using the power of Effect Derivatives">
<meta property="og:description" content="modelbased">
<meta property="og:image" content="/reference/figures/card.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@easystats4u">
<meta name="twitter:site" content="@easystats4u">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a>
    <a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a>
    <a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a>
    <a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a>
    <a class="dropdown-item" href="../articles/estimate_expectation.html">Use a model to make predictions</a>
    <a class="dropdown-item" href="../articles/describe_nonlinear.html">Describe non-linear curves</a>
    <a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a>
    <a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a>
    <a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Interpret simple and complex models using the power of Effect Derivatives</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/HEAD/vignettes/derivatives.Rmd" class="external-link"><code>vignettes/derivatives.Rmd</code></a></small>
      <div class="d-none name"><code>derivatives.Rmd</code></div>
    </div>

    
    
<p>One floating assumption that can be encountered is that ‚Äúcomplex
models‚Äù should be used for ‚Äúcomplex‚Äù stuff (data, designs, ‚Ä¶) and simple
models are enough for simple tasks. Why shoot a fly with a bazooka? In
this vignette, we are going to show that sometimes the bazooka is
actually so versatile that is works just as easily on a fly. In
particular, we will investigate how the combination <strong>GAM + Effect
Derivative</strong> can be used even in simple contexts to make your
data analysis easier.</p>
<div class="section level2">
<h2 id="the-traditional-approach">The Traditional Approach<a class="anchor" aria-label="anchor" href="#the-traditional-approach"></a>
</h2>
<p>We are interested in the relationship between <em>y</em> and
<em>x</em> in the following dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Package to fit GAMs</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span>

<span class="co"># Tidyverse</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="co"># Easystats</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/datawizard/" class="external-link">datawizard</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/" class="external-link">parameters</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/" class="external-link">modelbased</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/" class="external-link">report</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/" class="external-link">see</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span>

<span class="co"># Generate data</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">bayestestR</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/bayestestR/reference/simulate_correlation.html" class="external-link">simulate_correlation</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.85</span>, n <span class="op">=</span> <span class="fl">1000</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"x"</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-2-1.png" width="3281.25"></p>
<p>Upon visualizing the data, some people might go: ‚Äúwell the most
straightforward thing to do is to run a <strong>correlation
analysis</strong>‚Äù (they might not be wrong, but for the sake of the
demonstration, we will push things further in this walkthrough). Let‚Äôs
do that:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rez</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">y</span>, <span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
<span class="fu">report</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/report/reference/report.html" class="external-link">report</a></span><span class="op">(</span><span class="va">rez</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; 
&gt; 
&gt; The Pearson's product-moment correlation between data$y and data$x is positive,
&gt; statistically significant, and very large (r = 0.85, 95% CI [0.83, 0.87],
&gt; t(998) = 50.97, p &lt; .001)</code></pre>
<p>Great, we know there is a significant correlation between the two
variables! :partying_face: But what we would like to know is <strong>for
every increase of 1 on <em>x</em>, how much does <em>y</em>
increase?</strong> In other words, what is the <strong>slope</strong> of
the relationship?</p>
<p>The traditional approach to this is to fit a <strong>linear
model</strong> and assess its <strong>parameters</strong>. Indeed, the
slope of linear relationship between a predictor and its outcome is
actually what the <strong>effects</strong> observed in the regression
correspond to.</p>
<p>Let‚Äôs fit a linear regression model, visualize it, and describe its
parameters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_expectation.html">estimate_relation</a></span><span class="op">(</span><span class="va">model_lm</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-5-1.png" width="3281.25"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model_lm</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; Parameter   | Coefficient |   SE |          95% CI | t(998) |      p
&gt; --------------------------------------------------------------------
&gt; (Intercept) |      100.00 | 0.25 | [99.51, 100.49] | 400.00 | &lt; .001
&gt; x           |       12.75 | 0.25 | [12.26,  13.24] |  50.97 | &lt; .001</code></pre>
<p>So the parameters table shows us that the <strong>effect of
x</strong> is <code>12.75</code>. For every increase of 1 on
<code>x</code>, <code>y</code> increases by <code>12.75</code>.
Congrats, we‚Äôve answered our question!</p>
</div>
<div class="section level2">
<h2 id="gams-can-be-used-for-linear-relationships-too">GAMs can be used for linear relationships too!<a class="anchor" aria-label="anchor" href="#gams-can-be-used-for-linear-relationships-too"></a>
</h2>
<blockquote>
<p><em>A new player has entered the game.</em></p>
</blockquote>
<p>You might have heard of <strong>General Additive Models</strong>, aka
<strong>GAMs</strong>, that extend general linear models (GLMs) by
enabling a natural modelization of non-linear relationships. But we can
also use them <strong>for linear links</strong>, or in general if we are
not sure about the exact shape of the relationship. Because GAMs usually
penalize wiggly patterns, they have no problems with approximating
linear relationship with this is what the data indicates.</p>
<p>GAMs can be fitted using the <code>mgcv</code> package, and the only
change is that we need to specify as <strong>smooth</strong> term
(<code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s()</a></code>) for the variable that we want to estimate the
(non-necessarily linear) relationship for.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_gam</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_expectation.html">estimate_relation</a></span><span class="op">(</span><span class="va">model_gam</span><span class="op">)</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-6-1.png" width="3281.25"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model_gam</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; # Fixed Effects
&gt; 
&gt; Parameter   | Coefficient |   SE |          95% CI | t(998.00) |      p
&gt; -----------------------------------------------------------------------
&gt; (Intercept) |      100.00 | 0.25 | [99.51, 100.49] |    400.00 | &lt; .001
&gt; 
&gt; # Smooth Terms
&gt; 
&gt; Parameter       |       F |   df |      p
&gt; -----------------------------------------
&gt; Smooth term (x) | 2598.40 | 1.00 | &lt; .001</code></pre>
<p>Wow, the GAM-based modeled relationship is near-exactly the same as
that of the GLM! <strong>GAMs are powerful</strong> üòé</p>
<p>Okay, but there‚Äôs one <em>slight</em> issue. If you look at the
parameters table, there is indeed one line for the ‚Äúsmooth term‚Äù, but it
has‚Ä¶ no coefficient! Indeed, because GAM doesn‚Äôt model straight lines,
it doesn‚Äôt return the value of the slope. That‚Äôs why some people
consider GAMs complicated to discuss statistically, as their parameters
are not easily interpretable.</p>
<blockquote>
<p>Owww, so this is problematic considering our question about the
effect of <em>x</em> on <em>y</em> üòï</p>
</blockquote>
<p>Or <strong>is it?</strong></p>
</div>
<div class="section level2">
<h2 id="effect-derivatives">Effect Derivatives<a class="anchor" aria-label="anchor" href="#effect-derivatives"></a>
</h2>
<p>Let us introduce another concept that is likely to get very popular
in regression-modelling in the near future.
<strong>Derivatives</strong>. You might remember from your math class in
high school that derivatives are basically the <em>pattern of the slope
of a pattern</em>.</p>
<p><img src="../reference/figures/derivative.png" width="66%" style="display: block; margin: auto;"></p>
<p>In the figure above, the above plot shows a non-linear relationship
between the variables, and the below-plot shows its <strong>1st order
derivative</strong>, i.e., the evolution of the slope of that curve. It
might take a bit of time to mentally wrap your head around this
transformation, but once you get it it will become very easy to think in
terms of derivatives.</p>
<p>You can see that the derivative peaks when the slope of the
relationship is at its highest (when it is the steepest), and then
decrease again until reaching 0. A zero-crossing of the derivative means
an inversion of the the trend; it is when the relationship starts to be
negative.</p>
<p>Derivatives can be computed for statistical models, including simple
ones such as linear regressions. Before you look at the answer below,
try to think and imagine what would the derivative plot of our
previously computed linear model would look like?</p>
<p>We know that the slope is <code>12.75</code> (from our parameters
analysis). Does it change accross the course of the relationship? No,
because it is a straight line, so the slope is constant. If the slope is
constant, then the derivative should be‚Ä¶ a constant line too, right?
Let‚Äôs verify this.</p>
<p>To compute the derivative, we can use the
<code><a href="../reference/estimate_slopes.html">estimate_slopes()</a></code> function, and specify that we want to
know the trend of <em>x</em> <strong>over the course of</strong> (‚Äúat‚Äù)
itself.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deriv</span> <span class="op">&lt;-</span> <span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model_lm</span>, trend <span class="op">=</span> <span class="st">"x"</span>, at <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="co"># add a dashed line at 0 to show absence of effect</span></code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-8-1.png" width="3281.25"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; Average Marginal Effects
&gt; 
&gt; Start |  End |     x | Coefficient |   SE |         95% CI | t(998) |      p
&gt; ----------------------------------------------------------------------------
&gt; -3.38 | 3.28 | -0.05 |       12.75 | 0.25 | [12.26, 13.24] |  50.97 | &lt; .001
&gt; Marginal effects estimated for x</code></pre>
<p>The plot shows a straight horizontal line at 12.75, with a fixed
confidence interval (the same as in the parameter table). That is
expected, by definition, a linaer model models a straight line with a
fixed slope.</p>
<p>By running <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on the derivative, we obtain a
summary by ‚Äúsegments‚Äù (positive, flat, negative). Here, there is only
one segment, which average coefficient corresponds to the regression
parameter.</p>
<p><strong>This means that we don‚Äôt really need the parameters
table.</strong> Indeed, all the information about the slope can be
retrieved from the effect derivative. And guess what‚Ä¶ it can be applied
to <strong>any model</strong>‚Ä¶</p>
<p>Such as GAMs. Lets‚Äô to the same for our GAM model:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deriv</span> <span class="op">&lt;-</span> <span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model_gam</span>, trend <span class="op">=</span> <span class="st">"x"</span>, at <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">deriv</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-9-1.png" width="3281.25"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; Average Marginal Effects
&gt; 
&gt; Start |  End |     x | Coefficient |   SE |         95% CI | t(998.00) |      p
&gt; -------------------------------------------------------------------------------
&gt; -3.38 | 3.28 | -0.05 |       12.75 | 0.25 | [12.26, 13.24] |     50.97 | &lt; .001
&gt; Marginal effects estimated for x</code></pre>
<p>Isn‚Äôt that amazing, the results are <em>identical</em>. The moral of
the story is that GAMs can be used in a wide variety of contexts, even
for simple cases, and that derivatives are an easy way of interpreting
them.</p>
<p>Let‚Äôs jump to another example!</p>
</div>
<div class="section level2">
<h2 id="gam-derivatives-lm-a-polynomial-regression-example">GAM + Derivatives &gt; LM: a polynomial regression example<a class="anchor" aria-label="anchor" href="#gam-derivatives-lm-a-polynomial-regression-example"></a>
</h2>
<p>We mentioned that one of the GAMs ‚Äúlimitation‚Äù is that their
parameters are not easily interpretable. We were assuming that for other
classes of models, such as GLMs, it was the case.</p>
<p>However, it is <strong>very common to have difficult-to-interpret
parameters in normal regression models too!</strong> Let‚Äôs take the case
of a <strong>polynomial regression</strong>, that we could use to model
the following data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span><span class="op">$</span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-10-1.png" width="3281.25"></p>
<p>Let us fit a polynomial regression:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>

<span class="co"># Length is increased to have a smoother line</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_expectation.html">estimate_relation</a></span><span class="op">(</span><span class="va">model_poly</span>, length <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-11-1.png" width="3281.25"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model_poly</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; Parameter      | Coefficient |   SE |         95% CI | t(997) |      p
&gt; ----------------------------------------------------------------------
&gt; (Intercept)    |        1.01 | 0.02 | [ 0.98,  1.04] |  62.32 | &lt; .001
&gt; x [1st degree] |       -1.37 | 0.51 | [-2.38, -0.37] |  -2.68 | 0.007 
&gt; x [2nd degree] |       44.82 | 0.51 | [43.82, 45.83] |  87.38 | &lt; .001</code></pre>
<p>If you look at the parameters table, it is also a bit unclear what do
the coefficient refer too. How to interpret these numbers? Trying to
understand that would require you a lot of search and understanding
about how polynomials work. <strong>Ain‚Äôt nobody got time for
dat‚Äô!</strong></p>
<p>Instead, we can rely on our <em>good ol‚Äô</em> derivatives to obtain
the ‚Äúlinear slope‚Äù at every point of the curve.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deriv</span> <span class="op">&lt;-</span> <span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model_poly</span>, trend <span class="op">=</span> <span class="st">"x"</span>, at <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-12-1.png" width="3281.25"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; Average Marginal Effects
&gt; 
&gt; Start |   End |     x | Coefficient |   SE |         95% CI | t(997) |      p
&gt; -----------------------------------------------------------------------------
&gt; -3.38 | -0.42 | -1.90 |       -3.76 | 0.05 | [-3.85, -3.67] | -74.58 | &lt; .001
&gt; 0.32  |  3.28 |  1.80 |        3.61 | 0.05 | [ 3.52,  3.70] |  71.46 | &lt; .001
&gt; Marginal effects estimated for x</code></pre>
<p>If you know a bit theory about derivatives, you won‚Äôt be suprised to
find out that the derivative of a 2nd order polynomial
(<code>x + x^2</code>) is actually a linear line. We can see conclude
from this plot that the slope is (<strong>significantly</strong>,
because the confidence interval does not cover 0) negative until 0, and
then becomes positive. 0 corresponds indeed to the point of inversion of
the curve.</p>
<p>Moral of the story? <strong>Derivatives can be used to easily
interpret and draw conclusions about relationships from models in which
parameters are not straightforward to interpret.</strong></p>
<p>But, if you‚Äôve been attentive up to this point, you might wonder:
<strong>why bother with polynomials at all when GAMs can do the
trick?</strong></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_gam2</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">y2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_expectation.html">estimate_relation</a></span><span class="op">(</span><span class="va">model_gam2</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-13-1.png" width="3281.25"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Increase precision</span>
<span class="va">deriv</span> <span class="op">&lt;-</span> <span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model_gam2</span>, trend <span class="op">=</span> <span class="st">"x"</span>, at <span class="op">=</span> <span class="st">"x"</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">deriv</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> </code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-13-2.png" width="3281.25"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">deriv</span><span class="op">)</span></code></pre></div>
<pre><code>&gt; Average Marginal Effects
&gt; 
&gt; Start |   End |     x | Coefficient |   SE |         95% CI | t(991.26) |      p
&gt; --------------------------------------------------------------------------------
&gt; -3.38 | -0.08 | -1.73 |       -3.25 | 0.20 | [-3.63, -2.86] |    -16.61 | &lt; .001
&gt; -0.01 | -0.01 | -0.01 |       -0.09 | 0.11 | [-0.31,  0.14] |     -0.77 | 0.441 
&gt; 0.05  |  0.05 |  0.05 |        0.08 | 0.11 | [-0.14,  0.31] |      0.76 | 0.450 
&gt; 0.12  |  3.28 |  1.70 |        3.39 | 0.20 | [ 3.01,  3.78] |     17.37 | &lt; .001
&gt; Marginal effects estimated for x</code></pre>
<p>The conclusion is very similar, it shows a significant effect that
goes from negative to positive and becomes flat (i.e., non-significant)
around 0.</p>
<p>What about <em>3rd-degree-type</em> relationships? It works just the
same:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span><span class="op">$</span><span class="va">y3</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">model_gam3</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">y3</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_expectation.html">estimate_relation</a></span><span class="op">(</span><span class="va">model_gam3</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-14-1.png" width="3281.25"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deriv</span> <span class="op">&lt;-</span> <span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">model_gam3</span>, trend <span class="op">=</span> <span class="st">"x"</span>, at <span class="op">=</span> <span class="st">"x"</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">deriv</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> </code></pre></div>
<p><img src="derivatives_files/figure-html/unnamed-chunk-14-2.png" width="3281.25"></p>
<p>Again, the GAM nicely recovered the shape of the relationship. In
summary, effects derivatives can be used to easily leverage the power of
GAMs.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique
Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel
L√ºdecke</a>, <a href="https://github.com/mattansb" class="external-link">Mattan S.
Ben-Shachar</a>,
<a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet
Patil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
