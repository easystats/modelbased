<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>User Defined Contrasts and Joint Tests • modelbased</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="User Defined Contrasts and Joint Tests">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0.20</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-introductions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Introductions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-introductions">
<li><a class="dropdown-item" href="../articles/overview_of_vignettes.html">Overview of Vignettes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/mixed_models.html">Mixed effects models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpretation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_response.html">Use a model to make predictions</a></li>
    <li><a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Visualization</h6></li>
    <li><a class="dropdown-item" href="../articles/plotting.html">Plotting estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/estimate_relation.html">Visualize effects and interactions</a></li>
    <li><a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies">
<li><h6 class="dropdown-header" data-toc-skip>Workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/workflow_modelbased.html">Understanding your models</a></li>
    <li><a class="dropdown-item" href="../articles/practical_causality.html">Causal inference for observational data</a></li>
    <li><a class="dropdown-item" href="../articles/practical_intersectionality.html">Intersectionality analysis using the MAIHDA framework</a></li>
    <li><a class="dropdown-item" href="../articles/practical_inequalities.html">Measuring and comparing absolute and relative inequalities</a></li>
    <li><a class="dropdown-item" href="../articles/practical_its.html">Interrupted Time Series Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/practical_growthmixture.html">An Introduction to Growth Mixture Models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Contrasts</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_1.html">Contrasts and comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_2.html">User Defined Contrasts and Joint Tests</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_3.html">Slopes, floodlight and spotlight analysis (Johnson-Neyman intervals)</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_4.html">Contrasts and comparisons for generalized linear models</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_comparisons_5.html">Contrasts and comparisons for zero-inflation models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-easystats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="easystats"><span class="fa fab fa-r-project"></span> easystats</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-easystats">
<li><a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a></li>
    <li><a class="dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a></li>
    <li><a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>User Defined Contrasts and Joint Tests</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/main/vignettes/introduction_comparisons_2.Rmd" class="external-link"><code>vignettes/introduction_comparisons_2.Rmd</code></a></small>
      <div class="d-none name"><code>introduction_comparisons_2.Rmd</code></div>
    </div>

    
    
<p>This vignette is the second in a 5-part series:</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://easystats.github.io/modelbased/articles/introduction_comparisons_1.html"><strong>Contrasts
and Pairwise Comparisons</strong></a></p></li>
<li><p><strong>User Defined Contrasts and Joint Tests</strong></p></li>
<li><p><a href="https://easystats.github.io/modelbased/articles/introduction_comparisons_3.html"><strong>Comparisons
of Slopes, Floodlight and Spotlight Analysis (Johnson-Neyman
Intervals)</strong></a></p></li>
<li><p><a href="https://easystats.github.io/modelbased/articles/introduction_comparisons_4.html"><strong>Contrasts
and Comparisons for Generalized Linear Models</strong></a></p></li>
<li><p><a href="https://easystats.github.io/modelbased/articles/introduction_comparisons_5.html"><strong>Contrasts
and Comparisons for Zero-Inflation Models</strong></a></p></li>
</ol>
<div class="section level2">
<h2 id="user-defined-contrasts">User defined contrasts<a class="anchor" aria-label="anchor" href="#user-defined-contrasts"></a>
</h2>
<p>The first example demonstrates how to define and apply user-defined
contrasts to a factor variable within a linear model, respectively how
to avoid defining specific contrasts and instead directly formulate the
desired contrast as custom hypothesis in
<code><a href="../reference/estimate_contrasts.html">estimate_contrasts()</a></code>.</p>
<p>First, we define two specific contrasts: <code>treat_vs_none</code>
(comparing the average of two treatment levels to a control level) and
<code>short_vs_long</code> (comparing two treatment levels against each
other).</p>
<p>To illustrate the effect of these custom contrasts, the code creates
a copy of the original treatment factor (<code>dose_original</code>)
before applying the new contrasts to the <code>dose</code> factor. It
also centers a continuous predictor, <code>puppy_love</code>, to better
interpret the main effects of the interaction term.</p>
<p>Two linear models are then fitted: <code>m1</code> uses the
<code>dose</code> factor with the user-defined contrasts, while
<code>m2</code> uses the original <code>dose_original</code> factor. The
<code><a href="https://easystats.github.io/parameters/reference/compare_parameters.html" class="external-link">compare_parameters()</a></code> function is used to show that
<code>m1</code> directly estimates coefficients corresponding to
<code>treat_vs_none</code> and <code>short_vs_long</code>, which are not
directly available in <code>m2</code>.</p>
<p>Finally, the code uses <code><a href="../reference/estimate_means.html">estimate_means()</a></code> on
<code>m2</code> to get the marginal means for the original factor
levels, to identify which estimated means refer to which factor level.
This is required for the next step, where we use
<code><a href="../reference/estimate_contrasts.html">estimate_contrasts()</a></code> to perform hypothesis tests equivalent
to the user-defined contrasts, <code>((b2+b3)/2) = b1</code> (<em>the
average of two treatment levels - <code>b2 + b3 / 2</code> - to a
control level</em>) and <code>b3 = b2</code> (<em>comparing two
treatment levels against each other</em>), showing how such comparisons
can be made even without pre-defining contrasts on the factor
itself.</p>
<p>Data stems from the <a href="https://www.discovr.rocks" class="external-link">discovr</a> package (Field 2025).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/">modelbased</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/" class="external-link">parameters</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">puppy_love</span>, package <span class="op">=</span> <span class="st">"modelbased"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the levels for our treatment variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">puppy_love</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "No puppies" "15 mins"    "30 mins"</span></span>
<span></span>
<span><span class="co"># set contrasts</span></span>
<span><span class="va">treat_vs_none</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">short_vs_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we copy this variable to compare original factor contrasts with</span></span>
<span><span class="co"># user-defined factor contrasts</span></span>
<span><span class="va">puppy_love</span><span class="op">$</span><span class="va">dose_original</span> <span class="op">&lt;-</span> <span class="va">puppy_love</span><span class="op">$</span><span class="va">dose</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">puppy_love</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">treat_vs_none</span>, <span class="va">short_vs_long</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># center variable</span></span>
<span><span class="va">puppy_love</span><span class="op">$</span><span class="va">puppy_love</span> <span class="op">&lt;-</span> <span class="va">puppy_love</span><span class="op">$</span><span class="va">puppy_love</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">puppy_love</span><span class="op">$</span><span class="va">puppy_love</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit model, with user defined contrasts</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">happiness</span> <span class="op">~</span> <span class="va">puppy_love</span> <span class="op">*</span> <span class="va">dose</span>, data <span class="op">=</span> <span class="va">puppy_love</span><span class="op">)</span></span>
<span><span class="co"># fit model without user defined contrasts</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">happiness</span> <span class="op">~</span> <span class="va">puppy_love</span> <span class="op">*</span> <span class="va">dose_original</span>, data <span class="op">=</span> <span class="va">puppy_love</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we're interested in the effect (i.e. coefficient) of "treat_vs_none"</span></span>
<span><span class="co"># and "short_vs_long". These are 1.94 and 0.13 in model 1. In model 2,</span></span>
<span><span class="co"># we don't have these coefficient, because we didn't define related contrasts</span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/compare_parameters.html" class="external-link">compare_parameters</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameter                            |                   m1 |                   m2</span></span>
<span><span class="co">#&gt; ----------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; (Intercept)                          |  3.97 ( 3.34,  4.61) |  2.68 ( 1.54,  3.82)</span></span>
<span><span class="co">#&gt; puppy love                           |  0.45 ( 0.10,  0.81) |  0.76 ( 0.21,  1.31)</span></span>
<span><span class="co">#&gt; dose [treat_vs_none]                 |  1.94 ( 0.56,  3.32) |                     </span></span>
<span><span class="co">#&gt; dose [short_vs_long]                 |  0.13 (-1.40,  1.67) |                     </span></span>
<span><span class="co">#&gt; puppy love × dose [treat_vs_none]    | -0.46 (-1.18,  0.25) |                     </span></span>
<span><span class="co">#&gt; puppy love × dose [short_vs_long]    | -1.04 (-1.95, -0.13) |                     </span></span>
<span><span class="co">#&gt; dose original [15 mins]              |                      |  1.87 ( 0.23,  3.51)</span></span>
<span><span class="co">#&gt; dose original [30 mins]              |                      |  2.01 ( 0.49,  3.52)</span></span>
<span><span class="co">#&gt; puppy love × dose original [15 mins] |                      |  0.06 (-0.84,  0.95)</span></span>
<span><span class="co">#&gt; puppy love × dose original [30 mins] |                      | -0.98 (-1.77, -0.19)</span></span>
<span><span class="co">#&gt; ----------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Observations                         |                   30 |                   30</span></span>
<span></span>
<span><span class="co"># we first use `estimate_means()` to find which estimate relates</span></span>
<span><span class="co"># to which factor level of interest. we want to average the two</span></span>
<span><span class="co"># treatment level and compare it to the control level</span></span>
<span><span class="fu"><a href="../reference/estimate_means.html">estimate_means</a></span><span class="op">(</span><span class="va">m2</span>, <span class="st">"dose_original"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated Marginal Means</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; dose_original | Mean |   SE |       95% CI | t(24)</span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; No puppies    | 2.68 | 0.55 | [1.54, 3.82] |  4.83</span></span>
<span><span class="co">#&gt; 15 mins       | 4.55 | 0.57 | [3.38, 5.73] |  8.01</span></span>
<span><span class="co">#&gt; 30 mins       | 4.69 | 0.48 | [3.70, 5.67] |  9.79</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: happiness</span></span>
<span><span class="co">#&gt; Predictors modulated: dose_original</span></span>
<span><span class="co">#&gt; Predictors averaged: puppy_love (-5.9e-17)</span></span>
<span></span>
<span><span class="co"># treat_vs_none (i.e. average of short and long vs. none)</span></span>
<span><span class="co"># this contrasts corresponds to the estimate of the model m1, 1.94</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m2</span>, <span class="st">"dose_original"</span>, comparison <span class="op">=</span> <span class="st">"((b2+b3)/2) = b1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Contrasts Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter  | Difference |   SE |       95% CI | t(24) |     p</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; b2+b3/2=b1 |       1.94 | 0.67 | [0.56, 3.32] |  2.91 | 0.008</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: happiness</span></span>
<span><span class="co">#&gt; Predictors contrasted: dose_original</span></span>
<span><span class="co">#&gt; Predictors averaged: puppy_love (-5.9e-17)</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt; b2 = dose_original [15 mins]</span></span>
<span><span class="co">#&gt; b3 = dose_original [30 mins]</span></span>
<span><span class="co">#&gt; b1 = dose_original [No puppies]</span></span>
<span></span>
<span><span class="co"># short_vs_long</span></span>
<span><span class="co"># this contrasts corresponds to the estimate of the model m1, 0.13</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m2</span>, <span class="st">"dose_original"</span>, comparison <span class="op">=</span> <span class="st">"b3 = b2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Contrasts Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter | Difference |   SE |        95% CI | t(24) |     p</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; b3=b2     |       0.13 | 0.74 | [-1.40, 1.67] |  0.18 | 0.860</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: happiness</span></span>
<span><span class="co">#&gt; Predictors contrasted: dose_original</span></span>
<span><span class="co">#&gt; Predictors averaged: puppy_love (-5.9e-17)</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt; b3 = dose_original [30 mins]</span></span>
<span><span class="co">#&gt; b2 = dose_original [15 mins]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-a-matrix-for-contrasts">Using a matrix for contrasts<a class="anchor" aria-label="anchor" href="#using-a-matrix-for-contrasts"></a>
</h2>
<p>Comparisons are extremely flexible. For instance, it is possible to
calculate the marginal effects for the predictor
<code>puppy_love</code>, or the marginal effects for
<code>puppy_love</code> at each level of the treatment,
<code>dose_original</code>. We can do this by using
<code><a href="../reference/estimate_slopes.html">estimate_slopes()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># marginal effect for "puppy_love"</span></span>
<span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">m2</span>, <span class="st">"puppy_love"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated Marginal Effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Slope |   SE |       95% CI | t(24) |     p</span></span>
<span><span class="co">#&gt; -------------------------------------------</span></span>
<span><span class="co">#&gt; 0.35  | 0.17 | [0.00, 0.70] |  2.07 | 0.049</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal effects estimated for puppy_love</span></span>
<span><span class="co">#&gt; Type of slope was dY/dX</span></span>
<span></span>
<span><span class="co"># marginal effect for "puppy_love" at levels of "dose_original"</span></span>
<span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">m2</span>, <span class="st">"puppy_love"</span>, by <span class="op">=</span> <span class="st">"dose_original"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated Marginal Effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; dose_original | Slope |   SE |        95% CI | t(24) |     p</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; No puppies    |  0.76 | 0.27 | [ 0.21, 1.31] |  2.86 | 0.009</span></span>
<span><span class="co">#&gt; 15 mins       |  0.82 | 0.34 | [ 0.11, 1.53] |  2.40 | 0.025</span></span>
<span><span class="co">#&gt; 30 mins       | -0.22 | 0.28 | [-0.79, 0.35] | -0.79 | 0.436</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal effects estimated for puppy_love</span></span>
<span><span class="co">#&gt; Type of slope was dY/dX</span></span></code></pre></div>
<p>Again, it it possible to combine levels, by using a matrix that
defines the contrasts of interest, and pass this matrix as value for the
<code>comparison</code> argument.</p>
<p>In essence, in the next example, the marginal effect (slope) of
<code>puppy_love</code> within each level of <code>dose_original</code>
is calculated, and then two specific weighted combinations of these
slopes as defined by the <code>cond_tx</code> matrix are computed. The
first combination isolates and scales the slope from the first level of
<code>dose_original</code>, while the second creates a weighted sum of
the slopes from the second and third levels.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we want the marginal effects of slopes for treatment vs. no treatment</span></span>
<span><span class="co"># this is represented by the following contrast matrix</span></span>
<span><span class="va">cond_tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"no treatment"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"treatment"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># marginal effect for "puppy_love" at average effect of "treatment" (short + long)</span></span>
<span><span class="co"># and "no treatment"</span></span>
<span><span class="fu"><a href="../reference/estimate_slopes.html">estimate_slopes</a></span><span class="op">(</span><span class="va">m2</span>, <span class="st">"puppy_love"</span>, by <span class="op">=</span> <span class="st">"dose_original"</span>, comparison <span class="op">=</span> <span class="va">cond_tx</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated Marginal Effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter    | Slope |   SE |         95% CI | t(24) |     p</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; no treatment | -0.51 | 0.18 | [-0.88, -0.14] | -2.86 | 0.009</span></span>
<span><span class="co">#&gt; treatment    |  0.20 | 0.15 | [-0.10,  0.50] |  1.37 | 0.184</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal effects estimated for puppy_love</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="jointly-test-multiple-hypotheses">Jointly test multiple hypotheses<a class="anchor" aria-label="anchor" href="#jointly-test-multiple-hypotheses"></a>
</h2>
<p>The next example fits a linear model to predict
<code>alertness</code> based on an interaction between <code>time</code>
and <code>coffee</code>. It then calculates standard pairwise
comparisons for the levels of <code>time</code> separately within each
level of <code>coffee</code>. The final and key step performs a joint
test: for each level of <code>coffee</code>, it tests the overall
hypothesis that there is <em>any</em> significant difference among the
levels of <code>time</code>, rather than looking at individual pairwise
differences. This provides an omnibus test for the effect of
<code>time</code> within each <code>coffee</code> group. To conduct
joint tests, set <code>comparison = "joint"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coffee_data</span>, package <span class="op">=</span> <span class="st">"modelbased"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2 way interaction</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">alertness</span> <span class="op">~</span> <span class="va">time</span> <span class="op">*</span> <span class="va">coffee</span>, data <span class="op">=</span> <span class="va">coffee_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># contrasts of pairwise comparisons of levels of "time" within the</span></span>
<span><span class="co"># different levels of "coffee"</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m</span>, contrast <span class="op">=</span> <span class="st">"time"</span>, by <span class="op">=</span> <span class="st">"coffee"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Contrasts Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Level1    | Level2  | coffee  | Difference |   SE |        95% CI | t(114) |      p</span></span>
<span><span class="co">#&gt; -----------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; noon      | morning | coffee  |      -1.93 | 2.05 | [-5.99, 2.14] |  -0.94 |  0.350</span></span>
<span><span class="co">#&gt; afternoon | morning | coffee  |       1.93 | 2.05 | [-2.14, 5.99] |   0.94 |  0.350</span></span>
<span><span class="co">#&gt; afternoon | noon    | coffee  |       3.86 | 2.05 | [-0.21, 7.92] |   1.88 |  0.063</span></span>
<span><span class="co">#&gt; noon      | morning | control |       5.78 | 2.05 | [ 1.72, 9.85] |   2.82 |  0.006</span></span>
<span><span class="co">#&gt; afternoon | morning | control |       5.78 | 2.05 | [ 1.72, 9.85] |   2.82 |  0.006</span></span>
<span><span class="co">#&gt; afternoon | noon    | control |       0.00 | 2.05 | [-4.07, 4.07] |   0.00 | &gt; .999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable predicted: alertness</span></span>
<span><span class="co">#&gt; Predictors contrasted: time</span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span>
<span></span>
<span><span class="co"># jointly test whether the contrasts of all levels of time have an</span></span>
<span><span class="co"># effect within each level of "coffee"</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span><span class="va">m</span>, contrast <span class="op">=</span> <span class="st">"time"</span>, by <span class="op">=</span> <span class="st">"coffee"</span>, comparison <span class="op">=</span> <span class="st">"joint"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Joint Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrast | coffee  | df1 | df2 |    F |     p</span></span>
<span><span class="co">#&gt; ---------------------------------------------</span></span>
<span><span class="co">#&gt; time     | coffee  | 2   | 114 | 1.76 | 0.176</span></span>
<span><span class="co">#&gt; time     | control | 2   | 114 | 5.29 | 0.006</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
<p>The above example can be easily expanded to three-way
interactions.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3 way interaction</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">alertness</span> <span class="op">~</span> <span class="va">time</span> <span class="op">*</span> <span class="va">coffee</span> <span class="op">*</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">coffee_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># joint test of "time" levels within each group of coffee and sex</span></span>
<span><span class="fu"><a href="../reference/estimate_contrasts.html">estimate_contrasts</a></span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coffee"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>  comparison <span class="op">=</span> <span class="st">"joint"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Marginal Joint Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrast | coffee  | sex    | df1 | df2 |     F |      p</span></span>
<span><span class="co">#&gt; --------------------------------------------------------</span></span>
<span><span class="co">#&gt; time     | coffee  | female | 2   | 108 | 13.33 | &lt; .001</span></span>
<span><span class="co">#&gt; time     | control | female | 2   | 108 |  3.33 |  0.039</span></span>
<span><span class="co">#&gt; time     | coffee  | male   | 2   | 108 | 23.33 | &lt; .001</span></span>
<span><span class="co">#&gt; time     | control | male   | 2   | 108 | 43.33 | &lt; .001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values are uncorrected.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette showed advanced techniques for hypothesis testing in R
using the <strong>modelbased</strong> package.</p>
<p>Some key takeaways:</p>
<ul>
<li><p><strong>Flexible Custom Comparisons:</strong> You can move beyond
default contrasts by either directly defining contrast vectors for your
factors or, more flexibly, by specifying custom hypotheses as strings
(e.g., <code>"((b2+b3)/2) = b1"</code>) or using matrices within
functions like <code><a href="../reference/estimate_contrasts.html">estimate_contrasts()</a></code> and
<code><a href="../reference/estimate_slopes.html">estimate_slopes()</a></code>. This allows for highly specific and
theoretically driven comparisons, such as comparing an average of
multiple treatment levels to a control, or creating weighted
combinations of slopes.</p></li>
<li><p><strong>Powerful Joint Hypothesis Testing:</strong> The
<code>comparison = "joint"</code> argument in
<code><a href="../reference/estimate_contrasts.html">estimate_contrasts()</a></code> enables omnibus tests. This is
particularly useful for interactions, as it allows you to test whether a
factor (e.g., <code>time</code>) has any significant effect within each
level of another factor (e.g., <code>coffee</code>), providing a global
assessment before (or instead of) diving into all individual pairwise
comparisons.</p></li>
</ul>
<p><a href="https://easystats.github.io/modelbased/articles/introduction_comparisons_3.html">Go
to next vignette: <strong>Comparisons of Slopes, Floodlight and
Spotlight Analysis (Johnson-Neyman Intervals)</strong></a></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Field, A. P. (2025). Discovering statistics using R and RStudio (2nd
ed.). London: Sage.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="https://remi-theriault.com/" class="external-link">Rémi Thériault</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
