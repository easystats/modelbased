<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="modelbased">
<title>How to use Mixed models to Estimate Individuals' Scores • modelbased</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use Mixed models to Estimate Individuals' Scores">
<meta property="og:description" content="modelbased">
<meta property="og:image" content="/reference/figures/card.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@easystats4u">
<meta name="twitter:site" content="@easystats4u">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">modelbased</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/overview_of_vignettes.html">Overview of Vignettes</a>
    <a class="dropdown-item" href="../articles/visualisation_matrix.html">Data grids</a>
    <a class="dropdown-item" href="../articles/estimate_means.html">Marginal means</a>
    <a class="dropdown-item" href="../articles/estimate_contrasts.html">Contrast analysis</a>
    <a class="dropdown-item" href="../articles/estimate_slopes.html">Marginal effects and derivatives</a>
    <a class="dropdown-item" href="../articles/estimate_response.html">Use a model to make predictions</a>
    <a class="dropdown-item" href="../articles/describe_nonlinear.html">Describe non-linear curves</a>
    <a class="dropdown-item" href="../articles/derivatives.html">Interpret models using Effect Derivatives</a>
    <a class="dropdown-item" href="../articles/estimate_grouplevel.html">Estimate and re-use Random Effects</a>
    <a class="dropdown-item" href="../articles/modelisation_approach.html">The modelisation approach</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/easystats/modelbased/" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How to use Mixed models to Estimate Individuals' Scores</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/modelbased/blob/HEAD/vignettes/estimate_grouplevel.Rmd" class="external-link"><code>vignettes/estimate_grouplevel.Rmd</code></a></small>
      <div class="d-none name"><code>estimate_grouplevel.Rmd</code></div>
    </div>

    
    
<p>Mixed models are powerful tools that can be used for a variety of interesting purposes. Indeed, while they are typically used to be more accurate and resilient in estimating population-level effects (aka the “fixed” effects), they can also be used to gain insight into group-level effects (e.g., individuals’ scores, if the random factors are individuals).</p>
<p>For this practical walkthrough on <strong>advanced mixed model analysis</strong>, we will use the <strong>Speed-Accuracy Data</strong> (Wagenmakers, Ratcliff, Gomez, &amp; McKoon, 2008) from the <code>rtdists</code> package, in which <strong>17 participants</strong> (the <strong>id</strong> variable) performed some reaction time (RT) task under two conditions, speed and accuracy (the <strong>condition</strong> variable).</p>
<p>Our hypotheses is that participants are <strong>faster</strong> (i.e., lower RT) in the speed condition as compared to the accuracy condition. On the other hand, they will make less <strong>errors</strong> in the accuracy condition as compared to the speed condition.</p>
<p>In the following, we will load the necessary packages and clean the data by removing outliers and out-of-scope data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># easystats packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/" class="external-link">parameters</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/correlation/" class="external-link">correlation</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/" class="external-link">performance</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/" class="external-link">modelbased</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/datawizard/" class="external-link">datawizard</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/" class="external-link">see</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># other packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nathaneastwood.github.io/poorman/" class="external-link">poorman</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rtdists/rtdists/" class="external-link">rtdists</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">rtdists</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/rtdists/man/speed_acc.html" class="external-link">speed_acc</a></span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Remove outliers &amp;  Keep only word condition</span></span>
<span>  <span class="fu"><a href="https://nathaneastwood.github.io/poorman/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">rt</span> <span class="op">&lt;</span> <span class="fl">1.5</span>,</span>
<span>    <span class="va">stim_cat</span> <span class="op">==</span> <span class="st">"word"</span>,</span>
<span>    <span class="va">frequency</span> <span class="op">==</span> <span class="st">"low"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add new 'error' column that is 1 if the response doesn't match the category</span></span>
<span>  <span class="fu"><a href="https://nathaneastwood.github.io/poorman/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">stim_cat</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="speed-rt">Speed (RT)<a class="anchor" aria-label="anchor" href="#speed-rt"></a>
</h2>
<div class="section level3">
<h3 id="population-level-effects">Population-level Effects<a class="anchor" aria-label="anchor" href="#population-level-effects"></a>
</h3>
<p>For the reaction time, we will start by removing all the incorrect responses, since they are not reflective of a “successful” cognitive process. Then, and we will plot the RT according to the condition and stimulus category.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nathaneastwood.github.io/poorman/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">error</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_rt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">rt</span>, <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_grouplevel_files/figure-html/unnamed-chunk-3-1.png" width="2187.5"></p>
<p>The descriptive visualisation indeed seems to suggest that people are slower in the <strong>accuracy</strong> condition as compared to the <strong>speed</strong> condition. And there could also be a slight effect of <strong>frequency</strong>.</p>
<p>Let’s verify that using the <a href="https://easystats.github.io/modelbased/articles/modelisation_approach.html" class="external-link"><strong>modelisation approach</strong></a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">stim</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data_rt</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Let’s unpack the formula of this model. We’re tying to predict <code>rt</code> using different terms. These can be separated into two groups, the <em>fixed</em> effects and the <em>random</em> effects. Having <code>condition</code> as a fixed effect means that we are interested in estimating the <strong>“general”</strong> effect of the condition, across all subjects and items (i.e., at the <strong><em>population level</em></strong>). On top of that effect of condition, a second ‘fixed’ parameter was implicitly specified and will be estimated, the <strong>intercept</strong> (as you might know, one has to explicitly remove it through <code>rt ~ 0 + condition</code>, otherwise it is added automatically).</p>
<p>Let’s investigate these two fixed parameters first:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model_full</span>, effects <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; # Fixed Effects
&gt; 
&gt; Parameter         | Coefficient |   SE |         95% CI | t(4506) |      p
&gt; --------------------------------------------------------------------------
&gt; (Intercept)       |        0.69 | 0.02 | [ 0.65,  0.74] |   30.44 | &lt; .001
&gt; condition [speed] |       -0.16 | 0.02 | [-0.19, -0.12] |   -8.53 | &lt; .001</code></pre>
<p>Because <code>condition</code> is a factor with two levels, these parameters are easily interpretable. The <em>intercept</em> corresponds to the <code>rt</code> at the baseline level of the factor (accuracy), and the effect of condition corresponds to the change in <code>rt</code> between the intercept and the speed condition. In other words, the effect of <code>condition</code> refers to the difference between the two conditions, <code>speed - accuracy</code>.</p>
<p>As we can see, this difference is significant, and people have, <strong>in general</strong>, a lower <code>rt</code> (the sign is negative) in the speed condition.</p>
<p>Let’s visualize the <a href="https://easystats.github.io/modelbased/articles/estimate_means.html" class="external-link">marginal means</a> estimated by the model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_means.html">estimate_means</a></span><span class="op">(</span><span class="va">model_full</span><span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>show_data <span class="op">=</span> <span class="st">"violin"</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_grouplevel_files/figure-html/unnamed-chunk-6-1.png" width="2187.5"></p>
<p>Now, what’s up with the <strong>random effects</strong>. In the formula, we specified random intercepts (i.e., the right part of the bar <code>|</code> symbol) for <code>id</code> (the participants) and <code>stim</code>. That means that <strong>each participant and each stimulus will have its own “Intercept” parameter</strong> (which, as we’ve seen before, corresponds to the <code>rt</code> in the accuracy condition). Additionally, we’ve specified the random effect (“random slope” - the left side of the bar) of <code>condition</code> for each participant. That means that <strong>each participant will have its own effect of condition</strong> computed.</p>
<p>But do we need such a complex model? Let’s compare it to a model without specifying random intercepts for the stimuli.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_rt</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/test_performance.html" class="external-link">test_performance</a></span><span class="op">(</span><span class="va">model_full</span>, <span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Name       |   Model |      BF | df | df_diff |  Chi2 |      p
&gt; --------------------------------------------------------------
&gt; model_full | lmerMod |         |  7 |         |       |       
&gt; model      | lmerMod | &lt; 0.001 |  6 |   -1.00 | 36.78 | &lt; .001
&gt; Models were detected as nested and are compared in sequential order.</code></pre>
<p>Mmmh, it seems that the simpler model performs <strong>a lot worse</strong> (the Bayes Factor is lower than 1). We could run <code><a href="https://easystats.github.io/performance/reference/compare_performance.html" class="external-link">compare_performance()</a></code> to learn more details, but for this example we will go ahead and keep the <strong>worse model</strong> (for simplicity and conciseness when inspecting the random effects later, but keep in mind that in real life it’s surely not the best thing to do).</p>
</div>
<div class="section level3">
<h3 id="group-level-effects">Group-level Effects<a class="anchor" aria-label="anchor" href="#group-level-effects"></a>
</h3>
<p>That’s nice to know, but how to actually <strong>get access</strong> to these group-level scores. We can use the <code><a href="../reference/estimate_grouplevel.html">estimate_grouplevel()</a></code> function to retrieve them.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_grouplevel.html">estimate_grouplevel</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">random</span></span></code></pre></div>
<pre><code>&gt; Group | Level |      Parameter | Coefficient |   SE |         95% CI
&gt; --------------------------------------------------------------------
&gt; id    |     1 |    (Intercept) |       -0.10 | 0.01 | [-0.12, -0.07]
&gt; id    |     1 | conditionspeed |        0.09 | 0.02 | [ 0.06,  0.12]
&gt; id    |     2 |    (Intercept) |        0.08 | 0.02 | [ 0.04,  0.12]
&gt; id    |     2 | conditionspeed |       -0.03 | 0.02 | [-0.07,  0.01]
&gt; id    |     3 |    (Intercept) |        0.02 | 0.01 | [ 0.00,  0.05]
&gt; id    |     3 | conditionspeed |       -0.02 | 0.02 | [-0.05,  0.01]
&gt; id    |     4 |    (Intercept) |       -0.13 | 0.01 | [-0.15, -0.10]
&gt; id    |     4 | conditionspeed |        0.08 | 0.02 | [ 0.05,  0.11]
&gt; id    |     5 |    (Intercept) |       -0.05 | 0.01 | [-0.08, -0.03]
&gt; id    |     5 | conditionspeed |    6.67e-03 | 0.02 | [-0.02,  0.04]
&gt; id    |     6 |    (Intercept) |       -0.08 | 0.01 | [-0.10, -0.05]
&gt; id    |     6 | conditionspeed |        0.04 | 0.02 | [ 0.01,  0.07]
&gt; id    |     7 |    (Intercept) |       -0.09 | 0.01 | [-0.12, -0.07]
&gt; id    |     7 | conditionspeed |        0.10 | 0.02 | [ 0.06,  0.13]
&gt; id    |     8 |    (Intercept) |        0.21 | 0.01 | [ 0.19,  0.24]
&gt; id    |     8 | conditionspeed |       -0.18 | 0.02 | [-0.21, -0.14]
&gt; id    |     9 |    (Intercept) |        0.03 | 0.01 | [ 0.00,  0.05]
&gt; id    |     9 | conditionspeed |       -0.02 | 0.02 | [-0.05,  0.01]
&gt; id    |    10 |    (Intercept) |       -0.10 | 0.01 | [-0.13, -0.08]
&gt; id    |    10 | conditionspeed |        0.07 | 0.02 | [ 0.04,  0.10]
&gt; id    |    11 |    (Intercept) |       -0.09 | 0.01 | [-0.11, -0.07]
&gt; id    |    11 | conditionspeed |        0.07 | 0.02 | [ 0.04,  0.11]
&gt; id    |    12 |    (Intercept) |   -6.47e-04 | 0.01 | [-0.03,  0.02]
&gt; id    |    12 | conditionspeed |    3.65e-03 | 0.02 | [-0.03,  0.04]
&gt; id    |    13 |    (Intercept) |        0.08 | 0.01 | [ 0.05,  0.10]
&gt; id    |    13 | conditionspeed |       -0.06 | 0.02 | [-0.09, -0.02]
&gt; id    |    14 |    (Intercept) |        0.03 | 0.01 | [ 0.01,  0.06]
&gt; id    |    14 | conditionspeed |       -0.03 | 0.02 | [-0.06,  0.00]
&gt; id    |    15 |    (Intercept) |        0.09 | 0.01 | [ 0.07,  0.11]
&gt; id    |    15 | conditionspeed |       -0.07 | 0.02 | [-0.10, -0.04]
&gt; id    |    16 |    (Intercept) |        0.04 | 0.01 | [ 0.02,  0.06]
&gt; id    |    16 | conditionspeed |       -0.01 | 0.02 | [-0.05,  0.02]
&gt; id    |    17 |    (Intercept) |        0.06 | 0.01 | [ 0.03,  0.08]
&gt; id    |    17 | conditionspeed |       -0.05 | 0.02 | [-0.08, -0.02]</code></pre>
<p>Each of our participant (the <strong>Level</strong> column), numbered from 1 to 17, has two rows, corresponding to its own deviation from the main effect of the <strong>intercept</strong> and <strong>condition effect</strong>.</p>
<p>We can also use <code><a href="../reference/estimate_grouplevel.html">reshape_grouplevel()</a></code> to select only the <em>Coefficient</em> column (and skip the information about the uncertainty - which in real life is equally important!) and make it match the original data. The resulting table has the same length as the original dataset and can be merged with it: <strong>it’s a convenient way to re-incorporate the random effects into the data for further re-use</strong>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reshaped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_grouplevel.html">reshape_grouplevel</a></span><span class="op">(</span><span class="va">random</span>, indices <span class="op">=</span> <span class="st">"Coefficient"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reshaped</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt;   id id_Coefficient_Intercept id_Coefficient_conditionspeed
&gt; 1  1                   -0.097                         0.094
&gt; 2  1                   -0.097                         0.094
&gt; 3  1                   -0.097                         0.094
&gt; 4  1                   -0.097                         0.094
&gt; 5  1                   -0.097                         0.094
&gt; 6  1                   -0.097                         0.094</code></pre>
<p>As you can see, the first row is repeated as it corresponds to the same participant (so the random effects are the same). Note that we can use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to remove all the duplicate rows. Let’s add it to the original data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nathaneastwood.github.io/poorman/reference/mutate_joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">data_rt</span>, <span class="va">reshaped</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p>We can also visualize the random effects:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">random</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/theme_lucid.html" class="external-link">theme_lucid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_grouplevel_files/figure-html/unnamed-chunk-11-1.png" width="2187.5"></p>
<p>Wow! As we can see, there is a lot of between-participants variability. But what do these random parameters correspond to?</p>
</div>
<div class="section level3">
<h3 id="correlation-with-empirical-scores">Correlation with empirical scores<a class="anchor" aria-label="anchor" href="#correlation-with-empirical-scores"></a>
</h3>
<p>We said above that the random effects are the group-level (the group unit is, in this model, the participants) version of the population-level effects (the fixed effects). One important thing to note is that they represent the <strong>deviation from the fixed effect</strong>, so a coefficient close to 0 means that the participants’ effect is the same as the population-level effect. In other words, it’s <strong>“in the norm”</strong> (note that we can also obtain the group-specific effect corresponding to the sum of the fixed and random by changing the <code>type</code> argument).</p>
<p>Nevertheless, let’s compute some <strong>empirical scores</strong>, such as the condition averages for each participant.</p>
<p>We will group the data by participant and condition, get the mean RT, and then reshape the data so that we have, for each participant, the two means as two columns. Then, we will create a new dataframe (we will use the same - and overwrite it - to keep it concise), in which we will only keep the mean RT in the <strong>accuracy</strong> condition, and the difference with the <strong>speed</strong> condition <em>(reminds you of something?)</em>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">~</span> <span class="va">id</span> <span class="op">+</span> <span class="va">condition</span>, <span class="va">data_rt</span>, <span class="va">mean</span><span class="op">)</span> <span class="op"><a href="https://nathaneastwood.github.io/poorman/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_to_long.html" class="external-link">reshape_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"condition"</span>, values_from <span class="op">=</span> <span class="st">"rt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="va">data_sub</span><span class="op">$</span><span class="va">id</span>,</span>
<span>  empirical_accuracy <span class="op">=</span> <span class="va">data_sub</span><span class="op">$</span><span class="va">rt_accuracy</span>,</span>
<span>  empirical_condition <span class="op">=</span> <span class="va">data_sub</span><span class="op">$</span><span class="va">rt_speed</span> <span class="op">-</span> <span class="va">data_sub</span><span class="op">$</span><span class="va">rt_accuracy</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now, how to these <strong>empirical scores</strong> compare with the <strong>random effects</strong> estimated by the model? Let’s merge the empirical scores with the random effects scores. For that, we will run <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on the <strong>reshaped</strong> random effects to remove all the duplicate rows (and have only one row per participant, so that it matches the format of <code>data_sub</code>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nathaneastwood.github.io/poorman/reference/mutate_joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">data_sub</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reshaped</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s run a correlation between the model-based scores and the empirical scores.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/correlation/reference/correlation.html" class="external-link">correlation</a></span><span class="op">(</span><span class="va">data_sub</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; # Correlation Matrix (pearson-method)
&gt; 
&gt; Parameter1               |                    Parameter2 |     r |         95% CI |  t(15) |         p
&gt; ------------------------------------------------------------------------------------------------------
&gt; empirical_accuracy       |           empirical_condition | -0.94 | [-0.98, -0.84] | -10.72 | &lt; .001***
&gt; empirical_accuracy       |      id_Coefficient_Intercept |  1.00 | [ 1.00,  1.00] | 198.45 | &lt; .001***
&gt; empirical_accuracy       | id_Coefficient_conditionspeed | -0.98 | [-0.99, -0.93] | -17.37 | &lt; .001***
&gt; empirical_condition      |      id_Coefficient_Intercept | -0.93 | [-0.98, -0.82] | -10.10 | &lt; .001***
&gt; empirical_condition      | id_Coefficient_conditionspeed |  0.99 | [ 0.98,  1.00] |  29.16 | &lt; .001***
&gt; id_Coefficient_Intercept | id_Coefficient_conditionspeed | -0.97 | [-0.99, -0.92] | -15.95 | &lt; .001***
&gt; 
&gt; p-value adjustment method: Holm (1979)
&gt; Observations: 17</code></pre>
<p>First thing to notice is that <strong>everything is significantly and strongly correlated</strong>!.</p>
<p>Then, the empirical scores for accuracy and condition, corresponding to the “raw” average of RT, correlate <strong>almost perfectly with their model-based counterpart</strong> (<span class="math inline">\(r_{empirical\_accuracy/Coefficient\_Intercept} = 1\)</span>; <span class="math inline">\(r_{empirical\_condition/Coefficient\_conditionspeed} &gt; .99\)</span>). That’s reassuring, it means that our model has managed to estimate some intuitive parameters!</p>
<p>Finally, we can observe that there is a strong and negative correlation (which is even more salient with model-based indices) between the RT in the accuracy condition and the effect of the speed condition:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_sub</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">id_Coefficient_Intercept</span>, y <span class="op">=</span> <span class="va">id_Coefficient_conditionspeed</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/see/reference/theme_modern.html" class="external-link">theme_modern</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_grouplevel_files/figure-html/unnamed-chunk-15-1.png" width="2187.5"></p>
<p>The slower they are in the accuracy condition, the bigger the difference with the speed condition.</p>
</div>
</div>
<div class="section level2">
<h2 id="accuracy">Accuracy<a class="anchor" aria-label="anchor" href="#accuracy"></a>
</h2>
<p>In this section, we will take interest in the accuracy - the probability of making errors, using <strong>logistic models</strong>. For this, we will use the dataset that still includes the errors (<code>data</code>, and not <code>data_rt</code> used in the previous section).</p>
<p>We will fit a logistic mixed model to predict the likelihood of making error depending on the condition. Similarly, we specified a random intercept and random effect of condition for the participants.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">error</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">condition</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="st">"binomial"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="va">model</span>, effects <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; # Fixed Effects
&gt; 
&gt; Parameter         | Log-Odds |   SE |         95% CI |      z |      p
&gt; ----------------------------------------------------------------------
&gt; (Intercept)       |    -2.91 | 0.19 | [-3.28, -2.53] | -15.15 | &lt; .001
&gt; condition [speed] |     1.32 | 0.15 | [ 1.02,  1.61] |   8.73 | &lt; .001</code></pre>
<p>The parameters suggest that in general, participants indeed make more errors in the speed condition as compared to the accuracy condition. We can visualize the average probability (i.e., the <strong>marginal means</strong>) of making errors in the two conditions.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/estimate_means.html">estimate_means</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, show_data <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_grouplevel_files/figure-html/unnamed-chunk-17-1.png" width="2187.5"></p>
<p>Similarly, we can extract the group-level effects, clean them (rename the columns, otherwise it will be the same names as for the RT model), and merge them with the previous ones.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_grouplevel.html">estimate_grouplevel</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">random</span></span></code></pre></div>
<pre><code>&gt; Group | Level |      Parameter | Coefficient |   SE |         95% CI
&gt; --------------------------------------------------------------------
&gt; id    |     1 |    (Intercept) |   -4.68e-03 | 0.28 | [-0.55,  0.54]
&gt; id    |     1 | conditionspeed |       -0.32 | 0.30 | [-0.90,  0.26]
&gt; id    |     2 |    (Intercept) |       -0.54 | 0.41 | [-1.34,  0.26]
&gt; id    |     2 | conditionspeed |        0.11 | 0.36 | [-0.61,  0.82]
&gt; id    |     3 |    (Intercept) |       -0.26 | 0.30 | [-0.85,  0.32]
&gt; id    |     3 | conditionspeed |        0.22 | 0.30 | [-0.38,  0.81]
&gt; id    |     4 |    (Intercept) |       -0.63 | 0.33 | [-1.28,  0.01]
&gt; id    |     4 | conditionspeed |        0.21 | 0.32 | [-0.43,  0.84]
&gt; id    |     5 |    (Intercept) |       -0.28 | 0.31 | [-0.88,  0.32]
&gt; id    |     5 | conditionspeed |       -0.51 | 0.31 | [-1.12,  0.11]
&gt; id    |     6 |    (Intercept) |        0.17 | 0.26 | [-0.35,  0.69]
&gt; id    |     6 | conditionspeed |       -0.04 | 0.28 | [-0.60,  0.51]
&gt; id    |     7 |    (Intercept) |        0.91 | 0.21 | [ 0.49,  1.32]
&gt; id    |     7 | conditionspeed |        0.12 | 0.24 | [-0.35,  0.58]
&gt; id    |     8 |    (Intercept) |        1.18 | 0.21 | [ 0.77,  1.59]
&gt; id    |     8 | conditionspeed |       -0.03 | 0.24 | [-0.50,  0.43]
&gt; id    |     9 |    (Intercept) |       -0.24 | 0.30 | [-0.83,  0.35]
&gt; id    |     9 | conditionspeed |        0.19 | 0.31 | [-0.41,  0.79]
&gt; id    |    10 |    (Intercept) |       -0.20 | 0.29 | [-0.78,  0.37]
&gt; id    |    10 | conditionspeed |        0.29 | 0.30 | [-0.30,  0.88]
&gt; id    |    11 |    (Intercept) |        0.43 | 0.24 | [-0.05,  0.91]
&gt; id    |    11 | conditionspeed |        0.12 | 0.26 | [-0.39,  0.64]
&gt; id    |    12 |    (Intercept) |        1.00 | 0.21 | [ 0.59,  1.41]
&gt; id    |    12 | conditionspeed |       -0.77 | 0.25 | [-1.25, -0.29]
&gt; id    |    13 |    (Intercept) |        0.45 | 0.25 | [-0.04,  0.93]
&gt; id    |    13 | conditionspeed |       -0.12 | 0.27 | [-0.65,  0.40]
&gt; id    |    14 |    (Intercept) |       -0.32 | 0.31 | [-0.93,  0.29]
&gt; id    |    14 | conditionspeed |       -0.12 | 0.32 | [-0.73,  0.50]
&gt; id    |    15 |    (Intercept) |       -0.27 | 0.30 | [-0.86,  0.32]
&gt; id    |    15 | conditionspeed |        0.18 | 0.31 | [-0.42,  0.78]
&gt; id    |    16 |    (Intercept) |        0.21 | 0.26 | [-0.30,  0.73]
&gt; id    |    16 | conditionspeed |        0.13 | 0.28 | [-0.42,  0.68]
&gt; id    |    17 |    (Intercept) |       -1.16 | 0.38 | [-1.90, -0.42]
&gt; id    |    17 | conditionspeed |        0.17 | 0.35 | [-0.52,  0.86]</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">random</span><span class="op">)</span></span></code></pre></div>
<p><img src="estimate_grouplevel_files/figure-html/unnamed-chunk-18-1.png" width="2187.5"></p>
</div>
<div class="section level2">
<h2 id="log-shifted-model">Log-shifted Model<a class="anchor" aria-label="anchor" href="#log-shifted-model"></a>
</h2>
</div>
<div class="section level2">
<h2 id="scale-location-model">Scale-Location Model<a class="anchor" aria-label="anchor" href="#scale-location-model"></a>
</h2>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://github.com/mattansb" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
